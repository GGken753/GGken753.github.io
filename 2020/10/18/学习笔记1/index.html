<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>python爬虫笔记 | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub.  一.Py">
<meta property="og:type" content="article">
<meta property="og:title" content="python爬虫笔记">
<meta property="og:url" content="http://example.com/2020/10/18/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub.  一.Py">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/2020/10/18/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01%5Cimage-20201017155409804.png">
<meta property="og:image" content="http://example.com/2020/10/18/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01%5Cimage-20201017160505869.png">
<meta property="og:image" content="http://example.com/2020/10/18/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01%5Cimage-20201017160628973.png">
<meta property="og:image" content="http://example.com/2020/10/18/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01%5Cimage-20201017160803534.png">
<meta property="og:image" content="http://example.com/2020/10/18/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01%5Cimage-20201017160814578.png">
<meta property="og:image" content="http://example.com/2020/10/18/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01%5Cimage-20201017161013144.png">
<meta property="og:image" content="http://example.com/2020/10/18/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01%5Cimage-20201017161042340.png">
<meta property="og:image" content="http://example.com/2020/10/18/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01%5Cimage-20201017161643463.png">
<meta property="og:image" content="http://example.com/2020/10/18/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01%5Cimage-20201017161704503.png">
<meta property="og:image" content="http://example.com/2020/10/18/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01%5Cimage-20201017162022204.png">
<meta property="og:image" content="http://example.com/2020/10/18/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01%5Cimage-20201017162729575.png">
<meta property="og:image" content="http://example.com/2020/10/18/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01%5Cimage-20201017163033353.png">
<meta property="og:image" content="http://example.com/2020/10/18/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01%5Cimage-20201017163353698.png">
<meta property="og:image" content="http://example.com/2020/10/18/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01%5Cimage-20201017163433382.png">
<meta property="og:image" content="http://example.com/2020/10/18/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01%5Cimage-20201017163823454.png">
<meta property="og:image" content="http://example.com/2020/10/18/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01%5Cimage-20201017163846195.png">
<meta property="article:published_time" content="2020-10-18T01:24:28.000Z">
<meta property="article:modified_time" content="2020-10-18T02:17:23.359Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2020/10/18/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01%5Cimage-20201017155409804.png">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-学习笔记1" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/10/18/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/" class="article-date">
  <time datetime="2020-10-18T01:24:28.000Z" itemprop="datePublished">2020-10-18</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      python爬虫笔记
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Welcome to <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a target="_blank" rel="noopener" href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a target="_blank" rel="noopener" href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a target="_blank" rel="noopener" href="https://github.com/hexojs/hexo/issues">GitHub</a>. </p>
<p>一.Python爬虫</p>
<p>*什么是爬虫</p>
<p>网络爬虫，是一种按照一定规则，自动抓取互联网信息的程序或脚本，由于互联网数据的多样性和资源的有限性，根据用户需求定向抓取相关网页并分析已成为如今主流的爬取策略</p>
<p>*爬虫的本质是什么</p>
<p>模拟浏览器打开网页，获取网页中我们的那一部分数据</p>
<p>*编码规范</p>
<p>\1. 一般python程序第一行需要加入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\#-*-coding:utf-8-*-或者#coding&#x3D;utf-8</span><br></pre></td></tr></table></figure>

<p>这样可以在代码中包含中文；</p>
<p>\2. 在python中，使用函数实现单一功能或相关功能的代码段，可以提高可读性和代码重复利用率，函数的代码块以def关键词开头，后接空格，函数标识符名称，圆括号()、冒号：，括号中可以传入参数，函数段缩进（Tab或四个空格，只能任选一种），return用于函数结束，可以返回一个值，也可以不但任何表达式（表示返回None）</p>
<p>\3. python文件中可以加入main函数用于测试程序</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if_name_&#x3D;&#x3D;”_main_”:</span><br></pre></td></tr></table></figure>

<p>\4. python使用#添加注释，说明代码段的作用</p>
<p><img src="%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01%5Cimage-20201017155409804.png" alt="image-20201017155409804"></p>
<p> 二.准备工作</p>
<p>要向爬取网页需要准备好几个条件</p>
<p>1.引入模块</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">import bs4  #网页解析，获取数据</span><br><span class="line">import re   #正则表达式，进行文字匹配</span><br><span class="line">import urllib.request,urllib.error  #制定URL，获取网页数据</span><br><span class="line">import sqlite3   #进行sqlite数据库操作</span><br></pre></td></tr></table></figure>

<p>2.爬取网站</p>
<p>获取一个get请求</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">import urllib.request</span><br><span class="line">response &#x3D; urllib.request.urlopen(&quot;http:&#x2F;&#x2F;www.baidu.com&quot;)</span><br><span class="line">print(response)</span><br></pre></td></tr></table></figure>

<p>输出的结果为</p>
<p><img src="%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01%5Cimage-20201017160505869.png" alt="image-20201017160505869"></p>
<p>然后再进行对代码加工</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">import urllib.request</span><br><span class="line">response &#x3D; urllib.request.urlopen(&quot;http:&#x2F;&#x2F;www.baidu.com&quot;)</span><br><span class="line">print(response。read())</span><br></pre></td></tr></table></figure>

<p>得到下面的结果</p>
<p><img src="%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01%5Cimage-20201017160628973.png" alt="image-20201017160628973"></p>
<p>我们将上面的代码复制下来新建一个文件改后缀名为html,把代码复制上去</p>
<p><img src="%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01%5Cimage-20201017160803534.png" alt="image-20201017160803534"></p>
<p><img src="%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01%5Cimage-20201017160814578.png" alt="image-20201017160814578"></p>
<p>看上去还是很乱</p>
<p>对获取到的网页源码用decoode(“utf-8”)进行解析</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">import urllib.request</span><br><span class="line">response &#x3D; urllib.request.urlopen(&quot;http:&#x2F;&#x2F;www.baidu.com&quot;)</span><br><span class="line">print(response。read()。decode(&quot;utf-8&quot;))</span><br></pre></td></tr></table></figure>

<p>得到</p>
<p><img src="%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01%5Cimage-20201017161013144.png" alt="image-20201017161013144"></p>
<p>重复上面的做法的到</p>
<p><img src="%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01%5Cimage-20201017161042340.png" alt="image-20201017161042340"></p>
<p>获取一个post请求</p>
<p>首先打开测试网页httpbin.org</p>
<p>用post请求</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">import urllib.request</span><br><span class="line">import urllib.pase #解析器</span><br><span class="line">data &#x3D;bytes(urllib.parse.urlencode(&#123;&quot;hello&quot;:&quot;world&quot;&#125;),encoding&#x3D;&quot;utf-8&quot;) #二进制数据包</span><br><span class="line">response&#x3D;urllib.request.urlopen(&quot;http:&#x2F;&#x2F;httpbin.org&#x2F;post&quot;,data&#x3D;data)</span><br><span class="line">print(response.read().decode(&quot;utf-8&quot;))</span><br></pre></td></tr></table></figure>

<p>得到</p>
<p><img src="%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01%5Cimage-20201017161643463.png" alt="image-20201017161643463"></p>
<p>与测试网页post相应的返回值格式基本相似</p>
<p><img src="%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01%5Cimage-20201017161704503.png" alt="image-20201017161704503"></p>
<p>当使用get请求时</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">response &#x3D;urllib.request.urlopen(&quot;http:&#x2F;&#x2F;httpbin.org&#x2F;get&quot;)</span><br><span class="line">print(response.read().decode(&quot;utf-8&quot;))</span><br></pre></td></tr></table></figure>

<p>得到相应的结果</p>
<p><img src="%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01%5Cimage-20201017162022204.png" alt="image-20201017162022204"></p>
<p>3.超时处理</p>
<p>当对于一个网页的访问时长有一个时间限定时</p>
<p>例</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">response &#x3D;urllib.request.urlopen(&quot;http:&#x2F;&#x2F;httpbin.org&#x2F;get&quot;,timeout&#x3D;0.01)</span><br><span class="line">print(response.read().decode(&quot;utf-8&quot;))</span><br></pre></td></tr></table></figure>

<p>结果会报错</p>
<p>可以运用</p>
<p>try:</p>
<p>except</p>
<p>对执行的命令进行检测</p>
<p><img src="%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01%5Cimage-20201017162729575.png" alt="image-20201017162729575"></p>
<p>运行将返回一个</p>
<p>time out</p>
<p>4.其他爬取操作</p>
<p>/1例如我们想知道网页的状态码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">response &#x3D;urllib.request.urlopen(&quot;http:&#x2F;&#x2F;httpbin.org&quot;)</span><br><span class="line">print(response.status)</span><br></pre></td></tr></table></figure>

<p>输出为</p>
<p><img src="%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01%5Cimage-20201017163033353.png" alt="image-20201017163033353"></p>
<p>/2获取网页的headers</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">response &#x3D;urllib.request.urlopen(&quot;http:&#x2F;&#x2F;www.baidu.com&quot;)</span><br><span class="line">print(response.getheaders())</span><br></pre></td></tr></table></figure>

<p>输出</p>
<p><img src="%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01%5Cimage-20201017163353698.png" alt="image-20201017163353698"></p>
<p><img src="%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01%5Cimage-20201017163433382.png" alt="image-20201017163433382"></p>
<p>Getheaders(“”)””里面可填写headers里面的信息进去查询获取</p>
<p>/3伪装浏览器</p>
<p>因为网页的开发和设定，有些网页不允许爬</p>
<p>因此需要我们伪装浏览器</p>
<p><img src="%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01%5Cimage-20201017163823454.png" alt="image-20201017163823454"></p>
<p>输出</p>
<p><img src="%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01%5Cimage-20201017163846195.png" alt="image-20201017163846195"></p>
<p>发现我们的user-Agent为浏览器即伪装成功</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2020/10/18/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/" data-id="ckgdfpb2o00005cv38ubbe9k1" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2020/10/08/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">学习笔记一</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">October 2020</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/10/18/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/">python爬虫笔记</a>
          </li>
        
          <li>
            <a href="/2020/10/08/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">学习笔记一</a>
          </li>
        
          <li>
            <a href="/2020/10/02/hello-world/">Hello World</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 John Doe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>